import{r as $t,i as Tt,x as b,E as kt}from"./iframe-DgG1jxXy.js";import{t as At}from"./custom-element-UsVr97OX.js";import{n as p}from"./property-bBLjtija.js";import{n as S,e as E}from"./ref-CEeoAl58.js";import{n as V}from"./when-CI7b_ccM.js";import{S as Et}from"./mock-adapter-Dat2lqqN.js";import{g as T,d as St}from"./utils-C_XXmvvR.js";import"./ai-attachment-DpB2GDH5.js";import"./ai-chat-header-BZ7S2shu.js";import"./ai-chat-interface-O3KriPmW.js";import"./ai-file-picker-DHPQtBJt.js";import"./ai-message-thread-BCpR_-eH.js";import"./ai-prompt-Dg8VLnuh.js";import"./ai-spinner-rYjqHgsf.js";import"./ai-suggestions-Cn_LkW2d.js";import"./ai-voice-input-BheXpu8W.js";class zt{constructor(t){this._attachments=new Map,this._abortCallbacks=new Map,this._config=t}get pendingAttachments(){return Array.from(this._attachments.values()).filter(t=>t.status==="pending"||t.status==="uploading").map(t=>t.metadata)}get completedAttachments(){return Array.from(this._attachments.values()).filter(t=>t.status==="complete").map(t=>t.metadata)}get allAttachments(){return Array.from(this._attachments.values()).map(t=>t.metadata)}get isUploading(){return Array.from(this._attachments.values()).some(t=>t.status==="uploading")}updateConfig(t){this._config={...this._config,...t}}addAttachment(t,s){const a={id:t,status:"pending",...s};this._attachments.set(t,{id:t,metadata:a,status:"pending"}),this._config.onStateChange?.()}removeAttachment(t){this._attachments.delete(t),this._abortCallbacks.delete(t),this._config.onStateChange?.()}removeCompletedAttachment(t){this._attachments.get(t)?.status==="complete"&&(this._attachments.delete(t),this._config.onStateChange?.())}updateProgress(t,s){const a=this._attachments.get(t);a&&(a.status="uploading",a.metadata.uploading=!0,a.metadata.progress=s,a.metadata.status="uploading",this._config.onStateChange?.())}markComplete(t,s){const a=this._attachments.get(t);a&&(a.status="complete",a.uploadedFile=s,a.metadata.uploading=!1,a.metadata.progress=100,a.metadata.status="success",a.metadata.fileId=s.fileId,this._config.onStateChange?.())}markError(t,s){const a=this._attachments.get(t);a&&(a.status="error",a.errorMessage=s,a.metadata.uploading=!1,a.metadata.status="error",a.metadata.error=s,console.error(`File upload error for ${a.metadata.filename}: ${s}`),this._config.onError?.(s),this.removeAttachment(t))}registerOnAbort(t,s){this._abortCallbacks.set(t,s)}abort(t){const s=this._abortCallbacks.get(t);s&&s(),this.removeAttachment(t)}canSend(){return!Array.from(this._attachments.values()).some(t=>t.status==="uploading")}getCompletedUploads(){return Array.from(this._attachments.values()).filter(t=>t.status==="complete"&&t.uploadedFile).map(t=>t.uploadedFile)}clear(){this._attachments.clear(),this._abortCallbacks.clear(),this._config.onStateChange?.()}}class Ut{constructor(t,s){this._host=t,this._config=s,this._messageItems=[],this._toolCalls=new Map,t.addController(this)}hostConnected(){}hostDisconnected(){this._messageItems=[],this._toolCalls.clear()}updateConfig(t){this._config={...this._config,...t}}get messageItems(){return this._messageItems}getToolCall(t){return this._toolCalls.get(t)}#t(){this._host.requestUpdate()}addMessageItem(t){this._messageItems=[...this._messageItems,t],this.#t()}addMessage(t,s){this.getMessage(t.id)||(this.addMessageItem({type:"message",data:t}),s&&this.#s(t.id,{type:"message-start",timestamp:Date.now(),data:s,rawEvent:s.rawEvent}))}addToolCall(t,s){this._toolCalls.set(t.id,t),this.addMessageItem({type:"toolCall",data:t}),s&&this.#e(t.id,{type:"tool-call-start",timestamp:Date.now(),data:s,rawEvent:s.rawEvent})}updateToolCall(t,s,a){const n=this._toolCalls.get(t);if(!n)return;const h={...n,...s};if(this._toolCalls.set(t,h),this._messageItems=this._messageItems.map(d=>d.type==="toolCall"&&d.data.id===t?{...d,data:h}:d),a)if(a.eventType==="tool-call-args"){const d=a.event;this.#e(t,{type:"tool-call-args",timestamp:Date.now(),data:d,rawEvent:d.rawEvent})}else{const d=a.event;this.#e(t,{type:"tool-call-end",timestamp:Date.now(),data:d,rawEvent:d.rawEvent})}this.#t()}appendToMessage(t,s,a){this._messageItems=this._messageItems.map(n=>n.type==="message"&&n.data.id===t?{...n,data:{...n.data,content:n.data.content+s}}:n),a&&this.#s(t,{type:"message-delta",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#t()}getMessage(t){const s=this._messageItems.find(a=>a.type==="message"&&a.data.id===t);return s?.type==="message"?s.data:void 0}updateMessageStatus(t,s,a){this._messageItems=this._messageItems.map(n=>n.type==="message"&&n.data.id===t?{...n,data:{...n.data,status:s}}:n),a&&this.#s(t,{type:"message-end",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#t()}removeMessageItem(t){this._messageItems=this._messageItems.filter((s,a)=>a!==t),this.#t()}clearMessages(){this._messageItems=[],this._toolCalls.clear(),this.#t()}getMessages(){const t=new Map,s=[];for(const a of this._messageItems)if(a.type==="message"){const n={...a.data,toolCalls:[]};t.set(n.id,n),s.push(n.id)}for(const a of this._messageItems)if(a.type==="toolCall"){const n=t.get(a.data.messageId);n&&(n.toolCalls=[...n.toolCalls||[],a.data])}return s.map(a=>t.get(a)).filter(a=>a!==void 0)}setMessages(t){const s=[];this._toolCalls.clear();for(const a of t)if(s.push({type:"message",data:{...a,toolCalls:void 0}}),a.toolCalls)for(const n of a.toolCalls)s.push({type:"toolCall",data:n}),this._toolCalls.set(n.id,n);this._messageItems=s,this.#t()}#s(t,s){this._messageItems.some(n=>n.type==="message"&&n.data.id===t)&&(this._messageItems=this._messageItems.map(n=>{if(n.type==="message"&&n.data.id===t){const h=[...n.data.eventStream||[],s];return{...n,data:{...n.data,eventStream:h}}}return n}),this.#t())}#e(t,s){const a=this._toolCalls.get(t);if(!a)return;const n=[...a.eventStream||[],s],h={...a,eventStream:n};this._toolCalls.set(t,h),this._messageItems=this._messageItems.map(d=>d.type==="toolCall"&&d.data.id===t?{...d,data:h}:d),this.#t()}completeToolCall(t,s,a){this.updateToolCall(t,{result:s,status:"complete"}),a&&this.#e(t,{type:"tool-result",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#a(t)}#a(t){const s=this._toolCalls.get(t);if(!s)return;const a=this._messageItems.findIndex(M=>M.type==="message"&&M.data.id===s.messageId);if(a===-1)return;const n=this._messageItems[a];if(n.type!=="message"||n.data.content.trim())return;const h=this._messageItems.findIndex(M=>M.type==="toolCall"&&M.data.id===t);if(h===-1||h<=a)return;const[d]=this._messageItems.splice(a,1);this._messageItems.splice(h,0,d),this.#t()}}const Dt=':host{display:block;width:100%;height:100%}forge-ai-chat-interface::part(messages){overflow:hidden}forge-ai-chat-interface forge-ai-message-thread{min-height:0}.session-files{display:flex;flex-direction:column;gap:var(--forge-spacing-xsmall, 8px);min-width:0}.session-files .session-files-header{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-label1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-label1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-font-size-scale, .75)));font-weight:var(--forge-typography-label1-font-weight, 400);line-height:var(--forge-typography-label1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-line-height-scale, 1.25)));letter-spacing:var(--forge-typography-label1-letter-spacing, .0357142857em);text-transform:var(--forge-typography-label1-text-transform, inherit);text-decoration:var(--forge-typography-label1-text-decoration, inherit);color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6))}.session-files .session-files-list::-webkit-scrollbar{height:var(--forge-scrollbar-height, 16px);width:var(--forge-scrollbar-width, 16px)}.session-files .session-files-list::-webkit-scrollbar-track{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-track:hover{background-color:var(--forge-scrollbar-track-container-hover, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-corner{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-thumb{height:var(--forge-scrollbar-thumb-min-height, 32px);width:var(--forge-scrollbar-thumb-min-width, 32px);border-radius:var(--forge-scrollbar-border-radius, calc(var(--forge-shape-full, 9999px) * var(--forge-shape-factor, 1)));border-width:var(--forge-scrollbar-border-width, 3px);border-style:solid;border-color:transparent;background-color:var(--forge-scrollbar-thumb-container, var(--forge-theme-surface-container-medium, #c2c2c2));background-clip:content-box}.session-files .session-files-list::-webkit-scrollbar-thumb:hover{background-color:var(--forge-scrollbar-thumb-container-hover, var(--forge-theme-surface-container-high, #9e9e9e))}.session-files .session-files-list{display:flex;gap:var(--forge-spacing-small, 12px);overflow-x:auto;padding-block-end:var(--forge-spacing-xsmall, 8px)}';var Rt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,J=e=>{throw TypeError(e)},m=(e,t,s,a)=>{for(var n=a>1?void 0:a?Bt(t,s):t,h=e.length-1,d;h>=0;h--)(d=e[h])&&(n=(a?d(t,s,n):d(n))||n);return a&&n&&Rt(t,s,n),n},F=(e,t,s)=>t.has(e)||J("Cannot "+s),i=(e,t,s)=>(F(e,t,"read from private field"),s?s.call(e):t.get(e)),u=(e,t,s)=>t.has(e)?J("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),_=(e,t,s,a)=>(F(e,t,"write to private field"),t.set(e,s),s),r=(e,t,s)=>(F(e,t,"access private method"),s),Y=(e,t,s,a)=>({set _(n){_(e,t,n)},get _(){return i(e,t,a)}}),R,I,w,z,l,c,y,C,x,o,K,$,k,Q,U,v,B,A,X,Z,j,tt,et,W,st,at,it,ot,nt,rt,P,q,lt,D,ht,dt,ct,gt,mt,O,pt,ft,ut,bt,_t,yt,wt,vt,H,L,N,Ct,G,Mt,It,xt,f;const Ft="forge-ai-chatbot";let g=class extends Tt{constructor(){super(...arguments),u(this,o),this.fileUpload="off",this.voiceInput="on",this.placeholder="Ask a question...",this.showExpandButton=!1,this.showMinimizeButton=!1,this.expanded=!1,this.minimizeIcon="default",this.enableReactions=!1,this.titleText="AI Assistant",this.headingLevel=2,this.debugMode=!1,u(this,R,E()),u(this,I,E()),u(this,w,E()),u(this,z,E()),u(this,l),u(this,c),u(this,y),u(this,C),u(this,x,0)}connectedCallback(){super.connectedCallback(),_(this,l,new Ut(this,{tools:i(this,o,v)})),_(this,c,new zt({onError:e=>{r(this,o,f).call(this,{type:"forge-ai-chatbot-error",detail:{error:e}})},onStateChange:()=>{this.requestUpdate()}})),this.adapter&&r(this,o,B).call(this)}disconnectedCallback(){super.disconnectedCallback(),i(this,C)?.unsubscribe(),this.adapter?.disconnect()}willUpdate(e){e.has("adapter")&&this.adapter&&(_(this,y,void 0),r(this,o,B).call(this))}clearMessages(){i(this,l).clearMessages(),i(this,c).clear()}getMessages(){return i(this,l).getMessages()}setMessages(e){i(this,l).setMessages(e)}async sendMessage(e,t){if(!this.adapter){console.warn("No adapter configured.");return}if(i(this,w).value?.closeSlashMenu(),t){const s=Date.now();for(const a of t)r(this,o,O).call(this,a,s)}await r(this,o,q).call(this,{content:e,attachments:i(this,c).pendingAttachments})}abort(){r(this,o,D).call(this)}async scrollToBottom({behavior:e}={}){await i(this,I).value?.updateComplete,await new Promise(requestAnimationFrame),i(this,I).value?.scrollToBottom({behavior:e})}getThreadState(){return{threadId:this.adapter?.threadId,messages:this.getMessages(),timestamp:Date.now()}}setThreadState(e){this.setMessages(e.messages),e.threadId&&this.adapter&&(this.adapter.threadId=e.threadId)}render(){return b`
      <forge-ai-chat-interface
        ${S(i(this,R))}
        role="region"
        aria-label="AI chatbot"
        aria-live="polite"
        aria-busy=${i(this,o,k)}>
        <forge-ai-chat-header
          ${S(i(this,z))}
          slot="header"
          ?show-expand-button=${this.showExpandButton}
          ?show-minimize-button=${this.showMinimizeButton}
          ?expanded=${this.expanded}
          export-option=${i(this,o,U)?"enabled":"off"}
          clear-option=${i(this,o,U)?"enabled":"off"}
          .minimizeIcon=${this.minimizeIcon}
          .agentInfo=${this.agentInfo}
          .headingLevel=${this.headingLevel}
          .titleText=${this.titleText}
          @forge-ai-chat-header-expand=${r(this,o,wt)}
          @forge-ai-chat-header-minimize=${r(this,o,vt)}
          @forge-ai-chat-header-clear=${r(this,o,H)}
          @forge-ai-chat-header-export=${r(this,o,G)}
          @forge-ai-chat-header-info=${r(this,o,L)}>
        </forge-ai-chat-header>
        ${i(this,o,Mt)} ${i(this,o,xt)} ${i(this,o,It)}
      </forge-ai-chat-interface>
    `}};R=new WeakMap;I=new WeakMap;w=new WeakMap;z=new WeakMap;l=new WeakMap;c=new WeakMap;y=new WeakMap;C=new WeakMap;x=new WeakMap;o=new WeakSet;K=function(){const e=[];return i(this,o,U)&&(e.push({id:"clear",name:"Clear",group:"Conversation"}),e.push({id:"export",name:"Export",group:"Conversation"})),e.push({id:"info",name:"Info",group:"Help"}),e.push({id:"debug",name:`${this.debugMode?"Disable debug mode":"Enable debug mode"}`,group:"Help"}),e};$=function(){return i(this,l)?.messageItems??[]};k=function(){return(this.adapter?.isRunning??!1)||i(this,x)>0};Q=function(){return i(this,c)?.isUploading??!1};U=function(){return i(this,o,$).length>0};v=function(){return i(this,y)||_(this,y,new Map(this.adapter?.getTools().map(e=>[e.name,e])??[])),i(this,y)};B=async function(){!this.adapter||this.adapter.isConnecting||(await this.adapter.connect(),i(this,C)?.unsubscribe(),_(this,C,new Et),i(this,C).add(this.adapter.onMessageStart(r(this,o,A).bind(this)),this.adapter.onMessageDelta(r(this,o,X).bind(this)),this.adapter.onMessageEnd(r(this,o,Z).bind(this)),this.adapter.onToolCallStart(r(this,o,j).bind(this)),this.adapter.onToolCallArgs(r(this,o,tt).bind(this)),this.adapter.onToolCallEnd(r(this,o,et).bind(this)),this.adapter.onToolCall(r(this,o,st).bind(this)),this.adapter.onToolCallResult(r(this,o,rt).bind(this)),this.adapter.onRunAborted(r(this,o,ot).bind(this)),this.adapter.onError(r(this,o,it).bind(this)),this.adapter.onStateChange(r(this,o,nt).bind(this))),_(this,y,void 0),i(this,l)?.updateConfig({tools:i(this,o,v)}),r(this,o,f).call(this,{type:"forge-ai-chatbot-connected"}))};A=function(e){const t={id:e.messageId,role:"assistant",content:"",timestamp:Date.now(),status:"streaming"};i(this,l).addMessage(t,e)};X=function(e){if(!i(this,l).getMessage(e.messageId)){r(this,o,A).call(this,{messageId:e.messageId});return}i(this,l).appendToMessage(e.messageId,e.delta,e),this.scrollToBottom()};Z=function(e){i(this,l).updateMessageStatus(e.messageId,"complete",e);const t=i(this,l).getMessage(e.messageId);t&&r(this,o,f).call(this,{type:"forge-ai-chatbot-message-received",detail:{message:t}})};j=function(e){i(this,l).getMessage(e.messageId)||r(this,o,A).call(this,{messageId:e.messageId});const s={id:e.id,messageId:e.messageId,name:e.name,args:{},argsBuffer:"",status:"parsing",type:i(this,o,v).has(e.name)?"client":"agent"};i(this,l).addToolCall(s,e)};tt=function(e){const t={argsBuffer:e.argsBuffer,args:e.partialArgs??{}},s={eventType:"tool-call-args",event:e};i(this,l).updateToolCall(e.id,t,s),this.scrollToBottom()};et=function(e){const t={args:e.args,argsBuffer:void 0,status:"executing"},s={eventType:"tool-call-end",event:e};i(this,l).updateToolCall(e.id,t,s)};W=function(e,t){return typeof t=="string"||t&&typeof t=="object"?t:`Tool '${e}' executed successfully`};st=async function(e){i(this,l).getMessage(e.messageId)||r(this,o,A).call(this,{messageId:e.messageId});let s=i(this,l).getToolCall(e.id);if(s?i(this,l).updateToolCall(e.id,{args:e.args,status:"executing"}):(s={id:e.id,messageId:e.messageId,name:e.name,args:e.args,status:"executing",type:i(this,o,v).has(e.name)?"client":"agent"},i(this,l).addToolCall(s)),s?.type==="client"){r(this,o,f).call(this,{type:"forge-ai-chatbot-tool-call",detail:{toolCallId:e.id,toolName:e.name,arguments:e.args}});const a=i(this,o,v).get(e.name);a?.handler?await Promise.resolve(r(this,o,at).call(this,e.id,e.name,a.handler,e.args)):r(this,o,P).call(this,e.id,r(this,o,W).call(this,e.name))}};at=async function(e,t,s,a){Y(this,x)._++,this.requestUpdate();try{const h=await s({args:a,toolCallId:e,toolName:t,signal:void 0});await r(this,o,P).call(this,e,r(this,o,W).call(this,t,h))}catch(n){i(this,l).updateToolCall(e,{status:"error",result:{error:n.message}})}finally{Y(this,x)._--,this.requestUpdate()}};it=function(e){const t={id:T("msg"),role:"assistant",content:e.message,timestamp:Date.now(),status:"error"};i(this,l).addMessage(t),r(this,o,f).call(this,{type:"forge-ai-chatbot-error",detail:{error:e.message}})};ot=function(){const e={id:T("msg"),role:"system",content:"Run cancelled",timestamp:Date.now(),status:"complete"};i(this,l).addMessage(e)};nt=function(e){this.requestUpdate()};rt=function(e){i(this,l).completeToolCall(e.toolCallId,e.result,e),i(this,l).addMessage(e.message)};P=async function(e,t){!i(this,l).getToolCall(e)||!this.adapter||(i(this,l).completeToolCall(e,t),this.adapter.sendToolResult(e,t,this.getMessages()))};q=async function(e){if(!e.content.trim()||!this.adapter||i(this,o,k)){this.adapter||console.warn("No adapter configured.");return}if(!i(this,c).canSend())return;const t={id:T("msg"),role:"user",content:e.content,timestamp:e.timestamp??Date.now(),status:"pending"};i(this,l).addMessage(t),r(this,o,f).call(this,{type:"forge-ai-chatbot-message-sent",detail:{message:t}});try{this.adapter.sendMessage(this.getMessages()),i(this,l).updateMessageStatus(t.id,"complete")}catch(s){i(this,l).updateMessageStatus(t.id,"error");const a=s instanceof Error?s.message:"Failed to send message";r(this,o,f).call(this,{type:"forge-ai-chatbot-error",detail:{error:a}})}};lt=async function(e){const t=[...i(this,c).pendingAttachments];await r(this,o,q).call(this,{content:e.detail.value,timestamp:e.detail.date.getTime(),attachments:t})};D=function(){this.adapter?.isRunning&&this.adapter.abort(),this.requestUpdate()};ht=function(){r(this,o,D).call(this)};dt=async function(e){const t=i(this,l).getMessage(e.detail.messageId);if(t)try{await navigator.clipboard.writeText(t.content)}catch{}};ct=function(e){if(!this.adapter)return;const t=e.detail.messageId,s=i(this,o,$).findIndex(n=>n.type==="message"&&n.data.id===t);if(s===-1)return;let a=-1;for(let n=s-1;n>=0;n--){const h=i(this,o,$)[n];if(h.type==="message"&&h.data.role==="user"){a=n;break}}a!==-1&&(i(this,l).removeMessageItem(s),this.adapter.sendMessage(this.getMessages()))};gt=function(e){console.warn("thumbs-up",e.detail.messageId)};mt=function(e){console.warn("thumbs-down",e.detail.messageId)};O=function(e,t){const s=T("file");i(this,c).addAttachment(s,{filename:e.name,size:e.size,mimeType:e.type,timestamp:t});const a=r(this,o,ft).call(this,s);this.adapter?.emitFileUpload(e,a),r(this,o,f).call(this,{type:"forge-ai-chatbot-file-select",detail:{fileId:s,file:e,filename:e.name,size:e.size,mimeType:e.type,timestamp:t,...a}})};pt=function(e){const{file:t,timestamp:s}=e.detail;r(this,o,O).call(this,t,s)};ft=function(e){return{updateProgress:t=>{i(this,c).updateProgress(e,t)},markComplete:t=>{i(this,c).markComplete(e,t)},markError:t=>{i(this,c).markError(e,t)},onAbort:t=>{i(this,c).registerOnAbort(e,t)}}};ut=function(e){const t={id:T("msg"),role:"assistant",content:e.detail.message,timestamp:Date.now(),status:"error"};i(this,l).addMessage(t)};bt=function(e){const{filename:t}=e.detail,s=i(this,c).pendingAttachments.find(n=>n.filename===t);if(s){i(this,c).abort(s.id);return}const a=i(this,c).completedAttachments.find(n=>n.filename===t);a&&a.fileId&&(i(this,c).removeCompletedAttachment(a.id),this.requestUpdate(),this.adapter?.emitFileRemove(a.fileId,{onSuccess:()=>{},onError:n=>{console.error(`Failed to remove file ${t}:`,n)}}))};_t=async function(e){await this.sendMessage(e.detail.text),i(this,w).value?.focus()};yt=function(e){const{transcript:t}=e.detail;t&&i(this,w).value&&(i(this,w).value.value=t)};wt=function(){r(this,o,f).call(this,{type:"forge-ai-chatbot-expand"})};vt=function(){r(this,o,f).call(this,{type:"forge-ai-chatbot-minimize"})};H=function(){r(this,o,f).call(this,{type:"forge-ai-chatbot-clear",cancelable:!0}).defaultPrevented||this.clearMessages()};L=function(){const e=i(this,z).value;e?.showAgentInfo&&e.showAgentInfo(),r(this,o,f).call(this,{type:"forge-ai-chatbot-info"})};N=function(){this.debugMode=!this.debugMode};Ct=function(e){switch(e.detail.commandId){case"clear":r(this,o,H).call(this);break;case"export":r(this,o,G).call(this);break;case"info":r(this,o,L).call(this);break;case"debug":r(this,o,N).call(this);break}};G=function(){const e=this.getMessages();if(e.length===0)return;const t=e.map(a=>{const n=new Date(a.timestamp).toLocaleString(),h=a.role==="user"?"You":"Assistant";return`[${n}] ${h}:
${a.content}
`}).join(`
`),s=`chat-history-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`;St(t,s,"text/plain")};Mt=function(){const e=i(this,c).completedAttachments,s=[...i(this,c).pendingAttachments,...e];return s.length===0?kt:b`
      <div class="session-files" slot="attachments">
        <div class="session-files-header">Session Files (${s.length})</div>
        <div class="session-files-list">
          ${s.map(a=>b`
              <forge-ai-attachment
                .filename=${a.filename}
                .size=${a.size}
                ?uploading=${a.uploading??!1}
                removable
                @forge-ai-attachment-remove=${r(this,o,bt)}>
              </forge-ai-attachment>
            `)}
        </div>
      </div>
    `};It=function(){const e=i(this,o,Q);return b`
      <forge-ai-prompt
        ${S(i(this,w))}
        slot="prompt"
        .placeholder=${this.placeholder}
        .running=${i(this,o,k)||e}
        .slashCommands=${i(this,o,K)}
        ?disabled=${e}
        ?debug-mode=${this.debugMode}
        @forge-ai-prompt-send=${r(this,o,lt)}
        @forge-ai-prompt-stop=${r(this,o,D)}
        @forge-ai-prompt-cancel=${r(this,o,ht)}
        @forge-ai-prompt-debug-toggle=${r(this,o,N)}
        @forge-ai-prompt-command=${r(this,o,Ct)}>
        ${V(this.fileUpload==="on",()=>b`
            <forge-ai-file-picker
              slot="actions"
              variant="icon-button"
              multiple
              ?disabled=${e}
              .selectedFiles=${i(this,c).pendingAttachments.map(t=>t.filename)}
              @forge-ai-file-picker-change=${r(this,o,pt)}
              @forge-ai-file-picker-error=${r(this,o,ut)}>
            </forge-ai-file-picker>
          `)}
        ${V(this.voiceInput==="on",()=>b`
            <forge-ai-voice-input slot="actions" @forge-ai-voice-input-result=${r(this,o,yt)}>
            </forge-ai-voice-input>
          `)}
      </forge-ai-prompt>
    `};xt=function(){return b`
      <forge-ai-message-thread
        ${S(i(this,I))}
        .messageItems=${i(this,o,$)}
        .tools=${i(this,o,v)}
        ?enable-reactions=${this.enableReactions}
        ?show-thinking=${i(this,o,k)}
        ?debug-mode=${this.debugMode}
        @forge-ai-message-thread-copy=${r(this,o,dt)}
        @forge-ai-message-thread-refresh=${r(this,o,ct)}
        @forge-ai-message-thread-thumbs-up=${r(this,o,gt)}
        @forge-ai-message-thread-thumbs-down=${r(this,o,mt)}>
        <slot name="empty-state-heading" slot="empty-state-heading"></slot>
        <slot name="empty-state-message" slot="empty-state-message"></slot>
        <forge-ai-suggestions
          slot="empty-state-actions"
          variant="block"
          .suggestions=${this.suggestions??[]}
          @forge-ai-suggestions-select=${r(this,o,_t)}>
        </forge-ai-suggestions>
      </forge-ai-message-thread>
    `};f=function(e){const t=new CustomEvent(e.type,{detail:e.detail,bubbles:!0,composed:!0,cancelable:e.cancelable??!1});return this.dispatchEvent(t),t};g.styles=$t(Dt);m([p({attribute:!1})],g.prototype,"adapter",2);m([p({attribute:"file-upload"})],g.prototype,"fileUpload",2);m([p({attribute:"voice-input"})],g.prototype,"voiceInput",2);m([p()],g.prototype,"placeholder",2);m([p({attribute:!1})],g.prototype,"suggestions",2);m([p({type:Boolean,attribute:"show-expand-button"})],g.prototype,"showExpandButton",2);m([p({type:Boolean,attribute:"show-minimize-button"})],g.prototype,"showMinimizeButton",2);m([p({type:Boolean})],g.prototype,"expanded",2);m([p({attribute:"minimize-icon"})],g.prototype,"minimizeIcon",2);m([p({type:Boolean,attribute:"enable-reactions"})],g.prototype,"enableReactions",2);m([p({type:Object,attribute:!1})],g.prototype,"agentInfo",2);m([p({attribute:"title-text"})],g.prototype,"titleText",2);m([p({attribute:"heading-level",type:Number})],g.prototype,"headingLevel",2);m([p({type:Boolean,attribute:"debug-mode"})],g.prototype,"debugMode",2);g=m([At(Ft)],g);
