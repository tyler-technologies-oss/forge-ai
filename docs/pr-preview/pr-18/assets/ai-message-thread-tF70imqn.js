import{E as i,T as so,r as W,i as q,x as a}from"./iframe-UBQo4PCm.js";import{t as L}from"./custom-element-UsVr97OX.js";import{n as h}from"./property-D76MYmmc.js";import{e as B}from"./query-BpjciUlk.js";import{i as co,t as lo,a as go}from"./class-map-C-4gKB17.js";import{n as uo}from"./when-CI7b_ccM.js";import{r as fo}from"./utils-Dod8vlOP.js";import"./ai-empty-state-BjBj8rxI.js";import"./ai-error-message-jF6WdbtR.js";import"./ai-response-message-vyfN8Qy8.js";import"./ai-thinking-indicator-CSHTM5Kh.js";import"./ai-user-message-Dte2LBFK.js";import{r as N}from"./state-BQ3v4-l0.js";import{e as ho,n as po}from"./ref-DS4e2KKB.js";import"./popover-Cl_k0Lui.js";import"./ai-spinner-BthhXt10.js";import"./tooltip-vAaNcnQQ.js";class M extends co{constructor(t){if(super(t),this.it=i,t.type!==lo.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===i||t==null)return this._t=void 0,this.it=t;if(t===so)return t;if(typeof t!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this._t;this.it=t;const e=[t];return e.raw=e,this._t={_$litType$:this.constructor.resultType,strings:e,values:[]}}}M.directiveName="unsafeHTML",M.resultType=1;const T=go(M);class bo{#e;#o;#t=new Map;constructor(t){this.#e=t,t.addController(this)}hostConnected(){}hostDisconnected(){this.#o&&(cancelAnimationFrame(this.#o),this.#o=void 0),this.#t.clear()}#r(t,e){const r=e.length+":"+e.slice(0,50);return`${t}:${r}`}getCachedHtml(t,e){const r=this.#r(t,e);let n=this.#t.get(r);if(!n&&(n=fo(e),this.#t.set(r,n),this.#t.size>100)){const d=this.#t.keys().next().value;d&&this.#t.delete(d)}return n}scheduleUpdate(){this.#o||(this.#o=requestAnimationFrame(()=>{this.#o=void 0,this.#e.requestUpdate()}))}}const vo='.forge-icon-button{--_icon-button-display: var(--forge-icon-button-display, inline-flex);--_icon-button-size: var(--forge-icon-button-size, 48px);--_icon-button-gap: var(--forge-icon-button-gap, 0);--_icon-button-icon-color: var(--forge-icon-button-icon-color, currentColor);--_icon-button-background-color: var(--forge-icon-button-background-color, none);--_icon-button-icon-size: var(--forge-icon-button-icon-size, calc(var(--forge-typography-font-size, 1rem) * 1.5));--_icon-button-cursor: var(--forge-icon-button-cursor, pointer);--_icon-button-padding: var(--forge-icon-button-padding, var(--forge-spacing-xxsmall, 4px));--_icon-button-border: var(--forge-icon-button-border, none);--_icon-button-shadow: var(--forge-icon-button-shadow, none);--_icon-button-transition-duration: var(--forge-icon-button-transition-duration, var(--forge-animation-duration-short3, .15s));--_icon-button-transition-timing: var(--forge-icon-button-transition-timing, var(--forge-animation-easing-standard, cubic-bezier(.2, 0, 0, 1)));--_icon-button-shape: var(--forge-icon-button-shape, calc(var(--forge-shape-full, 9999px) * var(--forge-shape-factor, 1)));--_icon-button-shape-start-start: var(--forge-icon-button-shape-start-start, var(--_icon-button-shape));--_icon-button-shape-start-end: var(--forge-icon-button-shape-start-end, var(--_icon-button-shape));--_icon-button-shape-end-start: var(--forge-icon-button-shape-end-start, var(--_icon-button-shape));--_icon-button-shape-end-end: var(--forge-icon-button-shape-end-end, var(--_icon-button-shape));--_icon-button-shape-squared: var(--forge-icon-button-shape-squared, calc(var(--forge-shape-medium, 4px) * var(--forge-shape-factor, 1)));--_icon-button-outlined-border-width: var(--forge-icon-button-outlined-border-width, 1px);--_icon-button-outlined-border-style: var(--forge-icon-button-outlined-border-style, solid);--_icon-button-outlined-border-color: var(--forge-icon-button-outlined-border-color, var(--_icon-button-icon-color));--_icon-button-tonal-icon-color: var(--forge-icon-button-tonal-icon-color, var(--forge-theme-on-primary-container, #222c62));--_icon-button-tonal-background-color: var(--forge-icon-button-tonal-background-color, var(--forge-theme-primary-container, #d1d5ed));--_icon-button-filled-icon-color: var(--forge-icon-button-filled-icon-color, var(--forge-theme-on-primary, #ffffff));--_icon-button-filled-background-color: var(--forge-icon-button-filled-background-color, var(--forge-theme-primary, #3f51b5));--_icon-button-raised-shadow: var(--forge-icon-button-raised-shadow, 0px 3px 1px -2px rgba(0, 0, 0, .2), 0px 2px 2px 0px rgba(0, 0, 0, .14), 0px 1px 5px 0px rgba(0, 0, 0, .12));--_icon-button-raised-hover-shadow: var(--forge-icon-button-raised-hover-shadow, 0px 2px 4px -1px rgba(0, 0, 0, .2), 0px 4px 5px 0px rgba(0, 0, 0, .14), 0px 1px 10px 0px rgba(0, 0, 0, .12));--_icon-button-raised-active-shadow: var(--forge-icon-button-raised-active-shadow, 0px 5px 5px -3px rgba(0, 0, 0, .2), 0px 8px 10px 1px rgba(0, 0, 0, .14), 0px 3px 14px 2px rgba(0, 0, 0, .12));--_icon-button-raised-disabled-shadow: var(--forge-icon-button-raised-disabled-shadow, none);--_icon-button-density-small-size: var(--forge-icon-button-density-small-size, 24px);--_icon-button-density-small-padding: var(--forge-icon-button-density-small-padding, var(--forge-spacing-xxxsmall, 2px));--_icon-button-density-small-icon-size: var(--forge-icon-button-density-small-icon-size, calc(var(--forge-typography-font-size, 1rem) * 1.125));--_icon-button-density-medium-size: var(--forge-icon-button-density-medium-size, 36px);--_icon-button-density-medium-padding: var(--forge-icon-button-density-medium-padding, var(--forge-spacing-xxsmall, 4px));--_icon-button-density-large-size: var(--forge-icon-button-density-large-size, var(--_icon-button-size));--_icon-button-toggle-on-background-color: var(--forge-icon-button-toggle-on-background-color, var(--forge-theme-primary-container, #d1d5ed));--_icon-button-toggle-on-icon-color: var(--forge-icon-button-toggle-on-icon-color, var(--forge-theme-primary, #3f51b5));--_icon-button-outlined-toggle-on-background-color: var(--forge-icon-button-outlined-toggle-on-background-color, var(--forge-theme-primary-container, #d1d5ed));--_icon-button-outlined-toggle-on-icon-color: var(--forge-icon-button-outlined-toggle-on-icon-color, var(--forge-theme-primary, #3f51b5));--_icon-button-tonal-toggle-background-color: var(--forge-icon-button-tonal-toggle-background-color, var(--forge-theme-surface-container-low, #ebebeb));--_icon-button-tonal-toggle-on-background-color: var(--forge-icon-button-tonal-toggle-on-background-color, var(--forge-theme-primary-container, #d1d5ed));--_icon-button-tonal-toggle-on-icon-color: var(--forge-icon-button-tonal-toggle-on-icon-color, var(--forge-theme-primary, #3f51b5));--_icon-button-filled-toggle-background-color: var(--forge-icon-button-filled-toggle-background-color, var(--forge-theme-surface-container-low, #ebebeb));--_icon-button-filled-toggle-icon-color: var(--forge-icon-button-filled-toggle-icon-color, var(--forge-theme-primary, #3f51b5));--_icon-button-filled-toggle-on-background-color: var(--forge-icon-button-filled-toggle-on-background-color, var(--forge-theme-primary, #3f51b5));--_icon-button-filled-toggle-on-icon-color: var(--forge-icon-button-filled-toggle-on-icon-color, var(--forge-theme-on-primary, #ffffff));--_icon-button-disabled-cursor: var(--forge-icon-button-disabled-cursor, not-allowed);--_icon-button-disabled-opacity: var(--forge-icon-button-disabled-opacity, .38);--_icon-button-popover-icon-padding: var(--forge-icon-button-popover-icon-padding, var(--forge-spacing-xsmall, 8px));--_icon-button-focus-indicator-color: var(--forge-icon-button-focus-indicator-color, var(--forge-theme-primary, #3f51b5))}.forge-icon-button{outline:none;-webkit-tap-highlight-color:transparent;position:relative;z-index:0;display:var(--_icon-button-display);align-items:center;justify-content:center;gap:var(--_icon-button-gap);box-sizing:border-box;height:var(--_icon-button-density-large-size);min-width:var(--_icon-button-density-large-size);border:var(--_icon-button-border);border-start-start-radius:var(--_icon-button-shape-start-start);border-start-end-radius:var(--_icon-button-shape-start-end);border-end-start-radius:var(--_icon-button-shape-end-start);border-end-end-radius:var(--_icon-button-shape-end-end);padding:var(--_icon-button-padding);box-shadow:var(--_icon-button-shadow);color:var(--_icon-button-icon-color);background:var(--_icon-button-background-color);font-size:var(--_icon-button-icon-size);cursor:var(--_icon-button-cursor);-webkit-user-select:none;user-select:none;transition-property:box-shadow,background;transition-duration:var(--_icon-button-transition-duration);transition-timing-function:var(--_icon-button-transition-timing)}.forge-icon-button img,.forge-icon-button svg{height:var(--_icon-button-icon-size);width:var(--_icon-button-icon-size)}.forge-icon-button svg{fill:currentColor}.forge-icon-button:not(:disabled){--_state-layer-display: var(--forge-state-layer-display, flex);--_state-layer-color: var(--forge-state-layer-color, var(--forge-theme-on-surface, #000000));--_state-layer-hover-color: var(--forge-state-layer-hover-color, var(--_state-layer-color));--_state-layer-hover-opacity: var(--forge-state-layer-hover-opacity, .08);--_state-layer-pressed-color: var(--forge-state-layer-pressed-color, var(--_state-layer-color));--_state-layer-pressed-opacity: var(--forge-state-layer-pressed-opacity, .12);--_state-layer-hover-duration: var(--forge-state-layer-hover-duration, 15ms);--_state-layer-pressed-duration: var(--forge-state-layer-pressed-duration, 105ms);--_state-layer-animation-duration: var(--forge-state-layer-animation-duration, 375ms)}.forge-icon-button:not(:disabled):before{position:absolute;backface-visibility:hidden;transform:translateZ(0);background-color:var(--_state-layer-hover-color);inset:0;transition:opacity var(--_state-layer-hover-duration) linear,background-color var(--_state-layer-hover-duration) linear;--_state-layer-hover-duration: var(--forge-state-layer-hover-duration, .1s);content:"";opacity:0;border-radius:inherit}.forge-icon-button:not(:disabled):hover:before{background-color:var(--_state-layer-hover-color);opacity:var(--_state-layer-hover-opacity)}.forge-icon-button:not(:disabled):active:before{opacity:var(--_state-layer-pressed-opacity);transition-duration:var(--_state-layer-pressed-duration);--_state-layer-pressed-opacity: var(--forge-state-layer-pressed-opacity, .18)}.forge-icon-button:not(:disabled){--forge-state-layer-color: var(--_icon-button-icon-color)}@keyframes forge-focus-indicator-outward-grow{0%{outline-width:0}to{outline-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-outward-shrink{0%{outline-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-inward-grow{0%{border-width:0}to{border-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-inward-shrink{0%{border-width:var(--_focus-indicator-active-width)}}.forge-icon-button:not(:disabled){outline:none}.forge-icon-button:not(:disabled):focus-visible:after{--_focus-indicator-display: var(--forge-focus-indicator-display, flex);--_focus-indicator-width: var(--forge-focus-indicator-width, var(--forge-border-medium, 2px));--_focus-indicator-active-width: var(--forge-focus-indicator-active-width, 6px);--_focus-indicator-color: var(--forge-focus-indicator-color, var(--forge-theme-primary, #3f51b5));--_focus-indicator-shape: var(--forge-focus-indicator-shape, calc(var(--forge-shape-extra-small, 1px) * var(--forge-shape-factor, 1)));--_focus-indicator-duration: var(--forge-focus-indicator-duration, var(--forge-animation-duration-long4, .6s));--_focus-indicator-easing: var(--forge-focus-indicator-easing, var(--forge-animation-easing-emphasized, cubic-bezier(.2, 0, 0, 1)));--_focus-indicator-shape-start-start: var(--forge-focus-indicator-shape-start-start, var(--_focus-indicator-shape));--_focus-indicator-shape-start-end: var(--forge-focus-indicator-shape-start-end, var(--_focus-indicator-shape));--_focus-indicator-shape-end-end: var(--forge-focus-indicator-shape-end-end, var(--_focus-indicator-shape));--_focus-indicator-shape-end-start: var(--forge-focus-indicator-shape-end-start, var(--_focus-indicator-shape));--_focus-indicator-outward-offset: var(--forge-focus-indicator-outward-offset, var(--forge-spacing-xxsmall, 4px));--_focus-indicator-inward-offset: var(--forge-focus-indicator-inward-offset, 0px);--_focus-indicator-offset-block: var(--forge-focus-indicator-offset-block, 0);--_focus-indicator-offset-inline: var(--forge-focus-indicator-offset-inline, 0)}.forge-icon-button:not(:disabled):focus-visible:after{animation-delay:0s,calc(var(--_focus-indicator-duration) * .25);animation-duration:calc(var(--_focus-indicator-duration) * .25),calc(var(--_focus-indicator-duration) * .75);animation-timing-function:var(--_focus-indicator-easing);box-sizing:border-box;color:var(--_focus-indicator-color);display:none;pointer-events:none;position:absolute;margin-block:var(--_focus-indicator-offset-block);margin-inline:var(--_focus-indicator-offset-inline);animation-name:forge-focus-indicator-outward-grow,forge-focus-indicator-outward-shrink;border-end-end-radius:calc(var(--_focus-indicator-shape-end-end) + var(--_focus-indicator-outward-offset));border-end-start-radius:calc(var(--_focus-indicator-shape-end-start) + var(--_focus-indicator-outward-offset));border-start-end-radius:calc(var(--_focus-indicator-shape-start-end) + var(--_focus-indicator-outward-offset));border-start-start-radius:calc(var(--_focus-indicator-shape-start-start) + var(--_focus-indicator-outward-offset));inset:calc(-1 * var(--_focus-indicator-outward-offset));outline:var(--_focus-indicator-width) solid currentColor;content:"";display:block}.forge-icon-button:not(:disabled){--forge-focus-indicator-color: var(--_icon-button-focus-indicator-color);--forge-focus-indicator-shape: var(--_icon-button-shape)}.forge-icon-button:not(:disabled):where(.forge-icon-button--text,:not(:where(.forge-icon-button--outlined,.forge-icon-button--tonal,.forge-icon-button--filled,.forge-icon-button--raised))){--forge-focus-indicator-outward-offset: 0px}.forge-icon-button--outlined{border-width:var(--_icon-button-outlined-border-width);border-style:var(--_icon-button-outlined-border-style);border-color:var(--_icon-button-outlined-border-color)}.forge-icon-button--tonal{--_icon-button-icon-color: var(--_icon-button-tonal-icon-color);--_icon-button-background-color: var(--_icon-button-tonal-background-color)}.forge-icon-button--filled,.forge-icon-button--raised{--_icon-button-icon-color: var(--_icon-button-filled-icon-color);--_icon-button-background-color: var(--_icon-button-filled-background-color)}.forge-icon-button--raised{--_icon-button-shadow: var(--_icon-button-raised-shadow)}.forge-icon-button--raised:hover{--_icon-button-raised-shadow: var(--_icon-button-raised-hover-shadow)}.forge-icon-button--raised:active{--_icon-button-raised-shadow: var(--_icon-button-raised-active-shadow)}.forge-icon-button--squared{--_icon-button-shape: var(--_icon-button-shape-squared)}.forge-icon-button--small{--_icon-button-size: var(--_icon-button-density-small-size);--_icon-button-icon-size: var(--_icon-button-density-small-icon-size);--_icon-button-padding: var(--_icon-button-density-small-padding)}.forge-icon-button--small>*{font-size:var(--_icon-button-density-small-icon-size)}.forge-icon-button--medium{--_icon-button-size: var(--_icon-button-density-medium-size);--_icon-button-padding: var(--_icon-button-density-medium-padding)}.forge-icon-button:disabled{pointer-events:none;opacity:var(--_icon-button-disabled-opacity);pointer-events:auto;cursor:not-allowed}.forge-icon-button forge-circular-progress{--forge-circular-progress-indicator-color: var(--_icon-button-icon-color);--forge-circular-progress-track-color: transparent;--forge-circular-progress-size: 1em}:host{display:block}.tool-call{display:flex;align-items:center;gap:var(--forge-spacing-small, 12px);margin-block-end:var(--forge-spacing-small, 12px)}.debug-button{color:var(--forge-theme-on-error-container-low, #5f0011);--forge-icon-button-focus-indicator-color: var(--forge-theme-error, #b00020);--forge-icon-button-tonal-background-color: var(--forge-theme-error-container-low, #f6e0e4)}.tool-name{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-body1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-body1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-font-size-scale, .875)));font-weight:var(--forge-typography-body1-font-weight, 400);line-height:var(--forge-typography-body1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-line-height-scale, 1.125)));letter-spacing:var(--forge-typography-body1-letter-spacing, .0357142857em);text-transform:var(--forge-typography-body1-text-transform, inherit);text-decoration:var(--forge-typography-body1-text-decoration, inherit);color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6))}.status-icon{flex-shrink:0;display:flex;align-items:center;color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6))}.info-button{color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6))}.info-button:hover{color:var(--forge-theme-text-high, rgba(0, 0, 0, .87))}.tool-details{display:grid;gap:var(--forge-spacing-medium, 16px);padding:var(--forge-spacing-medium, 16px);min-width:300px;max-width:500px;min-height:100px;max-height:400px;overflow-y:auto}.tool-section{display:grid;gap:var(--forge-spacing-xsmall, 8px)}.section-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-heading1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-heading1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-heading1-font-size-scale, .875)));font-weight:var(--forge-typography-heading1-font-weight, 500);line-height:var(--forge-typography-heading1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-heading1-line-height-scale, 1.125)));letter-spacing:var(--forge-typography-heading1-letter-spacing, .0178571429em);text-transform:var(--forge-typography-heading1-text-transform, inherit);text-decoration:var(--forge-typography-heading1-text-decoration, inherit)}.code-block{background-color:var(--forge-theme-surface-container-minimum, #f5f5f5);color:var(--forge-theme-on-surface-container-minimum, #000000);padding:var(--forge-spacing-small, 12px);border-radius:calc(var(--forge-shape-medium, 4px) * var(--forge-shape-factor, 1));overflow-x:auto;margin:0;font-family:monospace;font-size:.85em;white-space:pre-wrap;word-wrap:break-word}';var mo=Object.defineProperty,yo=Object.getOwnPropertyDescriptor,U=o=>{throw TypeError(o)},v=(o,t,e,r)=>{for(var n=r>1?void 0:r?yo(t,e):t,d=o.length-1,y;d>=0;d--)(y=o[d])&&(n=(r?y(t,e,n):y(n))||n);return r&&n&&mo(t,e,n),n},A=(o,t,e)=>t.has(o)||U("Cannot "+e),s=(o,t,e)=>(A(o,t,"read from private field"),e?e.call(o):t.get(o)),x=(o,t,e)=>t.has(o)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),I=(o,t,e,r)=>(A(o,t,"write to private field"),t.set(o,e),e),_=(o,t,e)=>(A(o,t,"access private method"),e),z,p,c,V,F,G,J,S,K,D,R,O,Z,Q,X;const _o="forge-ai-chatbot-tool-call";let g=class extends q{constructor(){super(...arguments),x(this,c),this.debugMode=!1,this._popoverOpen=!1,this._debugPopoverOpen=!1,x(this,z,ho()),x(this,p),x(this,D,a`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24" fill="currentColor">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z" />
    </svg>
  `),x(this,R,a`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path
        d="M14 12h-4v-2h4m0 6h-4v-2h4m6-6h-2.81a6 6 0 0 0-1.82-1.96L17 4.41 15.59 3l-2.17 2.17a6 6 0 0 0-2.83 0L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20z" />
    </svg>
  `)}updated(o){if(super.updated(o),o.has("toolCall")||o.has("toolDefinition")){const t=this.toolDefinition?.renderer,e=s(this,z).value;if(e&&this.toolCall.status==="complete")if(s(this,p)&&e.contains(s(this,p))&&e.removeChild(s(this,p)),t?.elementTag){const r=document.createElement(t.elementTag);r.toolCall=this.toolCall,I(this,p,r),e.appendChild(r),_(this,c,S).call(this)}else t?.render&&(I(this,p,t.render(this.toolCall)),e.appendChild(s(this,p)),_(this,c,S).call(this))}}render(){const o=this.toolCall.status==="complete";return this.debugMode?a`
      <div class="tool-call">
        <span class="status-icon">${s(this,c,K)}</span>
        <span class="tool-name">${this.toolDefinition?.displayName??this.toolCall.name}</span>
        ${o?a`
              <button
                class="forge-icon-button forge-icon-button--small info-button"
                type="button"
                aria-label="${this._popoverOpen?"Hide":"Show"} tool details"
                aria-expanded="${this._popoverOpen}"
                @click=${_(this,c,V)}>
                ${s(this,D)}
              </button>
              ${s(this,c,Z)}
            `:i}
      </div>
      ${o?a`
            <forge-ai-popover
              .anchor=${this._infoButton}
              .open=${this._popoverOpen}
              placement="bottom-start"
              .flip=${!0}
              @forge-ai-popover-toggle=${_(this,c,F)}>
              ${s(this,c,X)}
            </forge-ai-popover>
          `:i}
      ${s(this,c,Q)} ${s(this,c,O)}
    `:this.toolDefinition?.renderer&&o?a`${s(this,c,O)}`:i}};z=new WeakMap;p=new WeakMap;c=new WeakSet;V=function(o){this._popoverOpen=!this._popoverOpen};F=function(o){this._popoverOpen=o.detail.newState==="open"};G=function(){this._debugPopoverOpen=!this._debugPopoverOpen};J=function(o){this._debugPopoverOpen=o.detail.open};S=function(){this.dispatchEvent(new CustomEvent("forge-ai-message-thread-scroll-request",{bubbles:!0,composed:!0}))};K=function(){switch(this.toolCall.status){case"pending":case"executing":return a`<forge-ai-spinner size="small"></forge-ai-spinner>`;case"complete":return a`
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24" fill="currentColor">
            <path d="M21 7 9 19l-5.5-5.5 1.41-1.41L9 16.17 19.59 5.59z" />
          </svg>
        `;case"error":return a`
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24" fill="currentColor">
            <path fill="none" d="M0 0h24v24H0z" />
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z" />
          </svg>
        `;default:return i}};D=new WeakMap;R=new WeakMap;O=function(){const o=this.toolDefinition?.renderer;return!o||this.toolCall.status!=="complete"?i:o.elementTag||o.render?a`<div ${po(s(this,z))}></div>`:i};Z=function(){return this.debugMode&&(this.toolCall.eventStream?.length??0)>0?a`
      <button
        id="debug-btn"
        aria-label="View event stream"
        class="forge-icon-button forge-icon-button--tonal forge-icon-button--small debug-button"
        @click=${_(this,c,G)}>
        ${s(this,R)}
      </button>
      ${this._debugPopoverOpen?a`<forge-ai-tooltip for="debug-btn" placement="bottom">Event Stream</forge-ai-tooltip>`:i}
    `:i};Q=function(){return this.debugMode&&this.toolCall.eventStream?a`
      <forge-ai-popover
        .anchor=${this._debugButton}
        .open=${this._debugPopoverOpen}
        id="debug-popover"
        placement="right"
        @forge-ai-popover-toggle=${_(this,c,J)}>
        <forge-ai-event-stream-viewer
          .events=${this.toolCall.eventStream}></forge-ai-event-stream-viewer>
      </forge-ai-popover>
    `:i};X=function(){const o=Object.keys(this.toolCall.args).length>0,t=this.toolCall.argsBuffer&&this.toolCall.argsBuffer.length>0,e=this.toolCall.result!==void 0;return a`
      <div class="tool-details">
        ${t?a`
              <div class="tool-section">
                <div class="section-label">Arguments (streaming):</div>
                <pre class="code-block">${this.toolCall.argsBuffer}</pre>
              </div>
            `:o?a`
                <div class="tool-section">
                  <div class="section-label">Arguments:</div>
                  <pre class="code-block">${JSON.stringify(this.toolCall.args,null,2)}</pre>
                </div>
              `:i}
        ${e?a`
              <div class="tool-section">
                <div class="section-label">Result:</div>
                <pre class="code-block">${JSON.stringify(this.toolCall.result,null,2)}</pre>
              </div>
            `:i}
      </div>
    `};g.styles=W(vo);v([h({attribute:!1})],g.prototype,"toolCall",2);v([h({attribute:!1})],g.prototype,"toolDefinition",2);v([h({type:Boolean,attribute:"debug-mode"})],g.prototype,"debugMode",2);v([N()],g.prototype,"_popoverOpen",2);v([N()],g.prototype,"_debugPopoverOpen",2);v([B(".info-button")],g.prototype,"_infoButton",2);v([B("#debug-btn")],g.prototype,"_debugButton",2);g=v([L(_o)],g);const wo=':host{display:grid;height:100%}.message-thread::-webkit-scrollbar{height:var(--forge-scrollbar-height, 16px);width:var(--forge-scrollbar-width, 16px)}.message-thread::-webkit-scrollbar-track{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.message-thread::-webkit-scrollbar-track:hover{background-color:var(--forge-scrollbar-track-container-hover, var(--forge-theme-surface-container-low, #ebebeb))}.message-thread::-webkit-scrollbar-corner{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.message-thread::-webkit-scrollbar-thumb{height:var(--forge-scrollbar-thumb-min-height, 32px);width:var(--forge-scrollbar-thumb-min-width, 32px);border-radius:var(--forge-scrollbar-border-radius, calc(var(--forge-shape-full, 9999px) * var(--forge-shape-factor, 1)));border-width:var(--forge-scrollbar-border-width, 3px);border-style:solid;border-color:transparent;background-color:var(--forge-scrollbar-thumb-container, var(--forge-theme-surface-container-medium, #c2c2c2));background-clip:content-box}.message-thread::-webkit-scrollbar-thumb:hover{background-color:var(--forge-scrollbar-thumb-container-hover, var(--forge-theme-surface-container-high, #9e9e9e))}.message-thread{display:flex;flex-direction:column;gap:var(--forge-spacing-medium, 16px);padding-block-end:var(--forge-spacing-large, 24px);overflow-y:auto;padding:var(--forge-spacing-medium, 16px) var(--forge-spacing-medium, 16px) var(--forge-spacing-xxlarge, 48px) var(--forge-spacing-medium, 16px)}@media not all and (min-resolution:.001dpcm){@supports (-webkit-appearance: none){.message-thread{overflow-y:scroll}}}.thinking-indicator{margin-block-start:var(--forge-spacing-xsmall, 8px)}.system-message{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-subheading2-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-subheading2-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-subheading2-font-size-scale, 1)));font-weight:var(--forge-typography-subheading2-font-weight, 400);line-height:var(--forge-typography-subheading2-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-subheading2-line-height-scale, 1.25)));letter-spacing:var(--forge-typography-subheading2-letter-spacing, normal);text-transform:var(--forge-typography-subheading2-text-transform, inherit);text-decoration:var(--forge-typography-subheading2-text-decoration, inherit);color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6));padding-block:var(--forge-spacing-small, 12px)}';var xo=Object.defineProperty,ko=Object.getOwnPropertyDescriptor,Y=o=>{throw TypeError(o)},m=(o,t,e,r)=>{for(var n=r>1?void 0:r?ko(t,e):t,d=o.length-1,y;d>=0;d--)(y=o[d])&&(n=(r?y(t,e,n):y(n))||n);return r&&n&&xo(t,e,n),n},E=(o,t,e)=>t.has(o)||Y("Cannot "+e),b=(o,t,e)=>(E(o,t,"read from private field"),e?e.call(o):t.get(o)),C=(o,t,e)=>t.has(o)?Y("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),P=(o,t,e,r)=>(E(o,t,"write to private field"),t.set(o,e),e),f=(o,t,e)=>(E(o,t,"access private method"),e),w,$,H,l,j,oo,to,eo,ro,ao,no,io,k;const Co="forge-ai-message-thread",$o=100;let u=class extends q{constructor(){super(...arguments),C(this,l),this.messageItems=[],this.enableReactions=!1,this.showThinking=!1,this.autoScroll="on",this.debugMode=!1,C(this,w),C(this,$,!0),C(this,H,()=>{const{scrollTop:o,scrollHeight:t,clientHeight:e}=this._messageThreadContainer;P(this,$,o+e>=t-$o)})}connectedCallback(){super.connectedCallback(),P(this,w,new bo(this))}updated(o){super.updated(o),this.autoScroll==="on"&&(o.has("messageItems")||o.has("showThinking"))&&this.scrollToBottom()}scrollToBottom({force:o=!1,behavior:t="smooth"}={}){if(!o&&!b(this,$))return;const e=this._messageThreadContainer;e.scrollTo({top:e.scrollHeight,behavior:t})}render(){return a`
      <div class="message-thread" @scroll=${this.autoScroll?b(this,H):void 0}>
        ${b(this,l,ao)} ${b(this,l,io)} ${b(this,l,no)}
      </div>
    `}};w=new WeakMap;$=new WeakMap;H=new WeakMap;l=new WeakSet;j=function(o){f(this,l,k).call(this,{type:"forge-ai-message-thread-copy",detail:{messageId:o}})};oo=function(o){f(this,l,k).call(this,{type:"forge-ai-message-thread-refresh",detail:{messageId:o}})};to=function(o){f(this,l,k).call(this,{type:"forge-ai-message-thread-thumbs-up",detail:{messageId:o}})};eo=function(o){f(this,l,k).call(this,{type:"forge-ai-message-thread-thumbs-down",detail:{messageId:o}})};ro=function(o){const t=this.tools?.get(o.name);return a`<forge-ai-chatbot-tool-call
      .toolCall=${o}
      .toolDefinition=${t}
      ?debug-mode=${this.debugMode}></forge-ai-chatbot-tool-call>`};ao=function(){return this.messageItems.length?i:a`
      <forge-ai-empty-state>
        <slot name="empty-state-heading" slot="heading">
          <span>How can I help you today?</span>
        </slot>
        <slot name="empty-state-message" slot="body">
          Start a conversation by asking a question or describing what you'd like help with.
        </slot>
        <slot name="empty-state-actions" slot="actions"></slot>
      </forge-ai-empty-state>
    `};no=function(){if(!this.showThinking)return i;const o=this.messageItems[this.messageItems.length-1];return o?.type!=="toolCall"&&o?.type==="message"&&o.data.role==="assistant"&&o.data.content.trim().length?i:this.debugMode&&o?.type==="toolCall"&&(o.data.status==="parsing"||o.data.status==="executing"||o.data.status==="pending")?i:a`<div class="thinking-indicator">
      <forge-ai-thinking-indicator class="status-indicator" show-text></forge-ai-thinking-indicator>
    </div>`};io=function(){return this.messageItems.filter(t=>t.type==="toolCall"?this.debugMode?!0:!!this.tools?.get(t.data.name)?.renderer:t.type==="message"?t.data.role!=="tool":!1).map(t=>{if(t.type==="toolCall")return f(this,l,ro).call(this,t.data);const e=t.data;if(e.role==="user"){const r=b(this,w).getCachedHtml(e.id,e.content);return a`<forge-ai-user-message>${T(r)}</forge-ai-user-message>`}else{if(e.role==="system")return a`<div class="system-message">${e.content}</div>`;if(e.status==="error"){const r=b(this,w).getCachedHtml(e.id,e.content);return a`
          <forge-ai-error-message>
            <span slot="title">Error</span>
            ${T(r)}
          </forge-ai-error-message>
        `}else return uo(e.content?.trim().length,()=>{const r=b(this,w).getCachedHtml(e.id,e.content);return a`
            <forge-ai-response-message
              ?complete=${e.status==="complete"}
              ?enable-reactions=${this.enableReactions}
              ?has-debug-data=${this.debugMode&&(e.eventStream?.length??0)>0}
              .eventStream=${e.eventStream}
              @forge-ai-response-message-copy=${()=>f(this,l,j).call(this,e.id)}
              @forge-ai-response-message-refresh=${()=>f(this,l,oo).call(this,e.id)}
              @forge-ai-response-message-thumbs-up=${()=>f(this,l,to).call(this,e.id)}
              @forge-ai-response-message-thumbs-down=${()=>f(this,l,eo).call(this,e.id)}>
              ${T(r)}
            </forge-ai-response-message>
          `})}})};k=function(o){const t=new CustomEvent(o.type,{detail:o.detail,bubbles:!0,composed:!0});return this.dispatchEvent(t),t};u.styles=W(wo);m([h({attribute:!1})],u.prototype,"messageItems",2);m([h({attribute:!1})],u.prototype,"tools",2);m([h({type:Boolean,attribute:"enable-reactions"})],u.prototype,"enableReactions",2);m([h({type:Boolean,attribute:"show-thinking"})],u.prototype,"showThinking",2);m([h({attribute:"auto-scroll"})],u.prototype,"autoScroll",2);m([h({type:Boolean,attribute:"debug-mode"})],u.prototype,"debugMode",2);m([B(".message-thread")],u.prototype,"_messageThreadContainer",2);u=m([L(Co)],u);
