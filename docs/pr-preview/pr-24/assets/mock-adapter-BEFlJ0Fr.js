import{g as l}from"./utils-Dod8vlOP.js";class n{#t=[];subscribe(t){return this.#t.push(t),{unsubscribe:()=>{const e=this.#t.indexOf(t);e>-1&&this.#t.splice(e,1)}}}emit(t){const e=[...this.#t];for(const s of e)try{s(t)}catch(i){console.error("Error in event listener:",i)}}clear(){this.#t=[]}get listenerCount(){return this.#t.length}}class _{#t=[];#e=!1;add(...t){if(this.#e){for(const e of t)e.unsubscribe();return}this.#t.push(...t)}unsubscribe(){if(!this.#e){this.#e=!0;for(const t of this.#t)try{t.unsubscribe()}catch(e){console.error("Error unsubscribing:",e)}this.#t=[]}}get isUnsubscribed(){return this.#e}}class m{constructor(){this._state={isConnected:!1,isConnecting:!1,isRunning:!1},this._tools=[],this._events={runStarted:new n,runFinished:new n,runAborted:new n,messageStart:new n,messageDelta:new n,messageEnd:new n,toolCall:new n,toolCallStart:new n,toolCallArgs:new n,toolCallEnd:new n,toolResult:new n,fileUpload:new n,fileRemove:new n,error:new n,stateChange:new n,customEvent:new n,rawEvent:new n,runStartedEvent:new n,stepStarted:new n,stepFinished:new n,stateSnapshot:new n,stateDelta:new n,activitySnapshot:new n,activityDelta:new n}}setTools(t){this._tools=t}getTools(){return[...this._tools]}getState(){return{...this._state}}get isConnected(){return this._state.isConnected}get isConnecting(){return this._state.isConnecting}get isRunning(){return this._state.isRunning}onRunStarted(t){return this._events.runStarted.subscribe(t)}onRunFinished(t){return this._events.runFinished.subscribe(t)}onRunAborted(t){return this._events.runAborted.subscribe(t)}onMessageStart(t){return this._events.messageStart.subscribe(t)}onMessageDelta(t){return this._events.messageDelta.subscribe(t)}onMessageEnd(t){return this._events.messageEnd.subscribe(t)}onToolCall(t){return this._events.toolCall.subscribe(t)}onToolCallStart(t){return this._events.toolCallStart.subscribe(t)}onToolCallArgs(t){return this._events.toolCallArgs.subscribe(t)}onToolCallEnd(t){return this._events.toolCallEnd.subscribe(t)}onToolCallResult(t){return this._events.toolResult.subscribe(t)}onFileUpload(t){return this._events.fileUpload.subscribe(t)}onFileRemove(t){return this._events.fileRemove.subscribe(t)}onError(t){return this._events.error.subscribe(t)}onStateChange(t){return this._events.stateChange.subscribe(t)}onCustomEvent(t){return this._events.customEvent.subscribe(t)}onRawEvent(t){return this._events.rawEvent.subscribe(t)}onRunStartedEvent(t){return this._events.runStartedEvent.subscribe(t)}onStepStarted(t){return this._events.stepStarted.subscribe(t)}onStepFinished(t){return this._events.stepFinished.subscribe(t)}onStateSnapshot(t){return this._events.stateSnapshot.subscribe(t)}onStateDelta(t){return this._events.stateDelta.subscribe(t)}onActivitySnapshot(t){return this._events.activitySnapshot.subscribe(t)}onActivityDelta(t){return this._events.activityDelta.subscribe(t)}_emitRunStarted(){this._events.runStarted.emit()}_emitRunFinished(){this._events.runFinished.emit()}_emitRunAborted(){this._events.runAborted.emit()}_emitMessageStart(t,e){this._events.messageStart.emit({messageId:t,rawEvent:e})}_emitMessageDelta(t,e,s){this._events.messageDelta.emit({messageId:t,delta:e,rawEvent:s})}_emitMessageEnd(t,e){this._events.messageEnd.emit({messageId:t,rawEvent:e})}_emitToolCall(t,e){this._events.toolCall.emit({...t,rawEvent:e})}_emitToolCallStart(t,e){this._events.toolCallStart.emit({...t,rawEvent:e})}_emitToolCallArgs(t,e){this._events.toolCallArgs.emit({...t,rawEvent:e})}_emitToolCallEnd(t,e){this._events.toolCallEnd.emit({...t,rawEvent:e})}_emitToolResult(t,e){this._events.toolResult.emit({...t,rawEvent:e})}emitFileUpload(t,e){this._events.fileUpload.emit({file:t,...e})}emitFileRemove(t,e){this._events.fileRemove.emit({fileId:t,...e})}_emitError(t){this._events.error.emit({message:t})}_emitCustomEvent(t,e,s){this._events.customEvent.emit({name:t,value:e,rawEvent:s})}_emitRawEvent(t,e){this._events.rawEvent.emit({event:t,rawEvent:e})}_emitRunStartedEvent(t,e,s){this._events.runStartedEvent.emit({threadId:t,runId:e,rawEvent:s})}_emitStepStarted(t,e){this._events.stepStarted.emit({stepName:t,rawEvent:e})}_emitStepFinished(t,e){this._events.stepFinished.emit({stepName:t,rawEvent:e})}_emitStateSnapshot(t,e){this._events.stateSnapshot.emit({state:t,rawEvent:e})}_emitStateDelta(t,e){this._events.stateDelta.emit({delta:t,rawEvent:e})}_emitActivitySnapshot(t,e,s,i){this._events.activitySnapshot.emit({activity:t,activityMessage:e,existingMessage:s,rawEvent:i})}_emitActivityDelta(t,e,s){this._events.activityDelta.emit({delta:t,activityMessage:e,rawEvent:s})}_updateState(t){this._state={...this._state,...t},this._events.stateChange.emit(this.getState())}}class d extends m{#t;#e=0;#s=null;get threadId(){return"mock-thread-123"}set threadId(t){}constructor(t={}){super(),this.#t={simulateTools:!1,simulateStreaming:!0,streamingDelay:50,responseDelay:500,mockResponses:["Hello! How can I assist you today?","That's a great question! Let me help you with that.",`I understand. Here's what I can do:

1. Answer questions
2. Help with tasks
3. Provide information

What would you like to do?`,"Here's some code:\n\n```typescript\nfunction greet(name: string) {\n  return `Hello, ${name}!`;\n}\n```\n\nThis is a simple greeting function."],...t},t.tools&&this.setTools(t.tools)}async connect(){this._updateState({isConnected:!0})}async disconnect(){this.abort(),this._updateState({isConnected:!1})}sendMessage(t,e){this._updateState({isRunning:!0});const s=l(),i=this.#t.mockResponses[this.#e%this.#t.mockResponses.length];this.#e++;const r=t[t.length-1],u=r?.role==="tool";if(this.#t.simulateTools&&this._tools.length>0&&!u){const a=r?.content?.toLowerCase()||"",h=a.includes("ask me")||a.includes("prompt me")||a.includes("get user input")||a.includes("get my input");this._emitMessageStart(s),h?this.#r(s):this.#i(s)}else u?this.#n(`Based on the tool result, ${i}`,s):this.#n(i,s)}sendToolResult(t,e,s){this.sendMessage(s)}abort(){this.#s!==null&&(clearTimeout(this.#s),this.#s=null),this._updateState({isRunning:!1})}#n(t,e){if(this._emitMessageStart(e),this.#t.simulateStreaming){const s=t.split(" ");s.forEach((i,r)=>{this.#s=window.setTimeout(()=>{this._emitMessageDelta(e,(r===0?"":" ")+i),r===s.length-1&&setTimeout(()=>{this._emitMessageEnd(e),this._updateState({isRunning:!1})},this.#t.streamingDelay)},this.#t.responseDelay+r*this.#t.streamingDelay)})}else setTimeout(()=>{this._emitMessageDelta(e,t),setTimeout(()=>{this._emitMessageEnd(e),this._updateState({isRunning:!1})},this.#t.streamingDelay)},this.#t.responseDelay)}#i(t){const e=l(),s="getCurrentWeather";setTimeout(()=>{setTimeout(()=>{setTimeout(()=>{setTimeout(()=>{this._emitToolCall({id:e,messageId:t,name:s,args:{location:"San Francisco"}}),setTimeout(()=>{this._emitMessageEnd(t),this._updateState({isRunning:!1})},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.responseDelay)}#r(t){const e=l(),s="getUserInput";setTimeout(()=>{setTimeout(()=>{setTimeout(()=>{setTimeout(()=>{this._emitToolCall({id:e,messageId:t,name:s,args:{prompt:"What is your name?"}}),setTimeout(()=>{this._emitMessageEnd(t),this._updateState({isRunning:!1})},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.streamingDelay)},this.#t.responseDelay)}}export{d as M,_ as S};
