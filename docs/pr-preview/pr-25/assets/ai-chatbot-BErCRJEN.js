import{r as tt,i as et,x as y,E as ot}from"./iframe-DyjsB23L.js";import{t as at}from"./custom-element-UsVr97OX.js";import{n as u}from"./property-J3kLzzhT.js";import{n as U,e as S}from"./ref-B8YufSM5.js";import{n as O}from"./when-CI7b_ccM.js";import{S as Yt}from"./mock-adapter-DPRgB_9-.js";import{g as I,d as Gt}from"./utils-Dod8vlOP.js";import"./ai-attachment-DybO5EIF.js";import"./ai-chat-header-BQ0kcMqJ.js";import"./ai-chat-interface-B_zJsca7.js";import"./ai-file-picker-DUjxges6.js";import"./ai-message-thread-D9tRHvZw.js";import"./ai-prompt-50tvHD-X.js";import"./ai-spinner-BV2hQxex.js";import"./ai-suggestions-DEYhDPl1.js";import"./ai-voice-input-I4sSXQKO.js";class Vt{constructor(t){this._attachments=new Map,this._abortCallbacks=new Map,this._config=t}get pendingAttachments(){return Array.from(this._attachments.values()).filter(t=>t.status==="pending"||t.status==="uploading").map(t=>t.metadata)}get completedAttachments(){return Array.from(this._attachments.values()).filter(t=>t.status==="complete").map(t=>t.metadata)}get allAttachments(){return Array.from(this._attachments.values()).map(t=>t.metadata)}get isUploading(){return Array.from(this._attachments.values()).some(t=>t.status==="uploading")}updateConfig(t){this._config={...this._config,...t}}addAttachment(t,o){const a={id:t,status:"pending",...o};this._attachments.set(t,{id:t,metadata:a,status:"pending"}),this._config.onStateChange?.()}removeAttachment(t){this._attachments.delete(t),this._abortCallbacks.delete(t),this._config.onStateChange?.()}removeCompletedAttachment(t){this._attachments.get(t)?.status==="complete"&&(this._attachments.delete(t),this._config.onStateChange?.())}updateProgress(t,o){const a=this._attachments.get(t);a&&(a.status="uploading",a.metadata.uploading=!0,a.metadata.progress=o,a.metadata.status="uploading",this._config.onStateChange?.())}markComplete(t,o){const a=this._attachments.get(t);a&&(a.status="complete",a.uploadedFile=o,a.metadata.uploading=!1,a.metadata.progress=100,a.metadata.status="success",a.metadata.fileId=o.fileId,this._config.onStateChange?.())}markError(t,o){const a=this._attachments.get(t);a&&(a.status="error",a.errorMessage=o,a.metadata.uploading=!1,a.metadata.status="error",a.metadata.error=o,console.error(`File upload error for ${a.metadata.filename}: ${o}`),this._config.onError?.(o),this.removeAttachment(t))}registerOnAbort(t,o){this._abortCallbacks.set(t,o)}abort(t){const o=this._abortCallbacks.get(t);o&&o(),this.removeAttachment(t)}canSend(){return!Array.from(this._attachments.values()).some(t=>t.status==="uploading")}getCompletedUploads(){return Array.from(this._attachments.values()).filter(t=>t.status==="complete"&&t.uploadedFile).map(t=>t.uploadedFile)}clear(){this._attachments.clear(),this._abortCallbacks.clear(),this._config.onStateChange?.()}}class Zt{constructor(t,o){this._host=t,this._config=o,this._messageItems=[],this._toolCalls=new Map,this._activeResponse=null,t.addController(this)}hostConnected(){}hostDisconnected(){this._messageItems=[],this._toolCalls.clear(),this._activeResponse=null}updateConfig(t){this._config={...this._config,...t}}get messageItems(){return this._messageItems}getToolCall(t){return this._toolCalls.get(t)}getActiveResponse(){return this._activeResponse}startResponse(){if(this._activeResponse)return this._activeResponse;const t={id:I(),children:[],status:"streaming",timestamp:Date.now()};return this._activeResponse=t,this._messageItems=[...this._messageItems,{type:"assistant",data:t}],this.#t(),t}addTextToResponse(t,o,a){const i=this._activeResponse??this.startResponse(),d=i.children.findIndex(l=>l.type==="text"&&l.messageId===t);if(d>=0){const l=i.children[d];l.type==="text"&&(l.content=o)}else i.children.push({type:"text",messageId:t,content:o,status:"streaming"});a&&this.#e({type:"message-start",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#o(),this.#t()}appendTextDelta(t,o,a){const i=this._activeResponse??this.startResponse(),d=i.children.find(l=>l.type==="text"&&l.messageId===t);d&&d.type==="text"?d.content+=o:i.children.push({type:"text",messageId:t,content:o,status:"streaming"}),a&&this.#e({type:"message-delta",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#o(),this.#t()}markTextComplete(t,o){if(!this._activeResponse)return;const a=this._activeResponse.children.find(i=>i.type==="text"&&i.messageId===t);a&&a.type==="text"&&(a.status="complete"),o&&this.#e({type:"message-end",timestamp:Date.now(),data:o,rawEvent:o.rawEvent}),this.#o(),this.#t()}addToolCallToResponse(t,o){const a=this._activeResponse??this.startResponse();if(this._toolCalls.set(t.id,t),a.children.push({type:"toolCall",data:t}),o){const i={type:"tool-call-start",timestamp:Date.now(),data:o,rawEvent:o.rawEvent};this.#e(i),this.#a(t.id,i)}this.#o(),this.#t()}updateToolCallInResponse(t,o,a){const i=this._toolCalls.get(t);if(!i)return;const d={...i,...o};if(this._toolCalls.set(t,d),this._activeResponse){for(const l of this._activeResponse.children)if(l.type==="toolCall"&&l.data.id===t){l.data=d;break}}if(a)if(a.eventType==="tool-call-args"){const l=a.event,b={type:"tool-call-args",timestamp:Date.now(),data:l,rawEvent:l.rawEvent};this.#e(b),this.#a(t,b)}else{const l=a.event,b={type:"tool-call-end",timestamp:Date.now(),data:l,rawEvent:l.rawEvent};this.#e(b),this.#a(t,b)}this.#o(),this.#t()}completeToolCallInResponse(t,o,a){if(this.updateToolCallInResponse(t,{result:o,status:"complete"}),a){const i={type:"tool-result",timestamp:Date.now(),data:a,rawEvent:a.rawEvent};this.#e(i),this.#a(t,i)}}completeResponse(){this._activeResponse&&(this._activeResponse.status="complete",this.#o(),this._activeResponse=null,this.#t())}#o(){const t=this._activeResponse;t&&(this._messageItems=this._messageItems.map(o=>o.type==="assistant"&&o.data.id===t.id?{type:"assistant",data:{...t}}:o))}#e(t){this._activeResponse&&(this._activeResponse.eventStream=[...this._activeResponse.eventStream||[],t])}#a(t,o){const a=this._toolCalls.get(t);if(!a)return;const i=[...a.eventStream||[],o],d={...a,eventStream:i};if(this._toolCalls.set(t,d),this._activeResponse){for(const l of this._activeResponse.children)if(l.type==="toolCall"&&l.data.id===t){l.data=d;break}}}#t(){this._host.requestUpdate()}addMessageItem(t){this._messageItems=[...this._messageItems,t],this.#t()}addMessage(t,o){this.getMessage(t.id)||(this.addMessageItem({type:"message",data:t}),o&&this.#s(t.id,{type:"message-start",timestamp:Date.now(),data:o,rawEvent:o.rawEvent}))}getMessage(t){const o=this._messageItems.find(a=>a.type==="message"&&a.data.id===t);return o?.type==="message"?o.data:void 0}updateMessageStatus(t,o,a){this._messageItems=this._messageItems.map(i=>i.type==="message"&&i.data.id===t?{...i,data:{...i.data,status:o}}:i),a&&this.#s(t,{type:"message-end",timestamp:Date.now(),data:a,rawEvent:a.rawEvent}),this.#t()}removeMessageItem(t){this._messageItems=this._messageItems.filter((o,a)=>a!==t),this.#t()}clearMessages(){this._messageItems=[],this._toolCalls.clear(),this._activeResponse=null,this.#t()}removeMessageItemsFrom(t){this._messageItems=this._messageItems.slice(0,t),this._activeResponse=null,this.#t()}getMessages(){const t=[];for(const o of this._messageItems)if(o.type==="message")t.push({...o.data,toolCalls:[]});else if(o.type==="assistant"){const a=o.data,i=a.children.filter(b=>b.type==="text").map(b=>b.content).join(""),d=a.children.filter(b=>b.type==="toolCall").map(b=>b.data),l={id:a.id,role:"assistant",content:i,timestamp:a.timestamp,status:a.status==="streaming"?"streaming":a.status==="error"?"error":"complete",toolCalls:d.length?d:void 0,eventStream:a.eventStream};t.push(l)}else if(o.type==="toolCall"){const a=t[t.length-1];a&&a.role==="assistant"&&(a.toolCalls=[...a.toolCalls||[],o.data])}return t}setMessages(t){const o=[];this._toolCalls.clear(),this._activeResponse=null;for(const a of t)if(a.role==="assistant"){const i=[];if(a.content?.trim()&&i.push({type:"text",messageId:a.id,content:a.content,status:"complete"}),a.toolCalls)for(const l of a.toolCalls)i.push({type:"toolCall",data:l}),this._toolCalls.set(l.id,l);const d={id:a.id,children:i,status:a.status==="streaming"?"streaming":a.status==="error"?"error":"complete",timestamp:a.timestamp,eventStream:a.eventStream};o.push({type:"assistant",data:d})}else o.push({type:"message",data:{...a,toolCalls:void 0}});this._messageItems=o,this.#t()}#s(t,o){this._messageItems.some(i=>i.type==="message"&&i.data.id===t)&&(this._messageItems=this._messageItems.map(i=>{if(i.type==="message"&&i.data.id===t){const d=[...i.data.eventStream||[],o];return{...i,data:{...i.data,eventStream:d}}}return i}),this.#t())}}const st="confirmToolCall",Jt='.forge-button{--_button-primary-color: var(--forge-button-primary-color, var(--forge-theme-primary, #3f51b5));--_button-text-color: var(--forge-button-text-color, var(--_button-primary-color));--_button-disabled-color: var(--forge-button-disabled-color, var(--forge-theme-surface-container, #e0e0e0));--_button-padding: var(--forge-button-padding, var(--forge-spacing-medium, 16px));--_button-display: var(--forge-button-display, inline-grid);--_button-justify: var(--forge-button-justify, center);--_button-shape: var(--forge-button-shape, calc(var(--forge-shape-medium, 4px) * var(--forge-shape-factor, 1)));--_button-height: var(--forge-button-height, 36px);--_button-min-width: var(--forge-button-min-width, 64px);--_button-spacing: var(--forge-button-spacing, var(--forge-spacing-xsmall, 8px));--_button-border-width: var(--forge-button-border-width, medium);--_button-border-style: var(--forge-button-border-style, none);--_button-border-color: var(--forge-button-border-color, currentColor);--_button-shape-start-start-radius: var(--forge-button-shape-start-start-radius, var(--_button-shape));--_button-shape-start-end-radius: var(--forge-button-shape-start-end-radius, var(--_button-shape));--_button-shape-end-start-radius: var(--forge-button-shape-end-start-radius, var(--_button-shape));--_button-shape-end-end-radius: var(--forge-button-shape-end-end-radius, var(--_button-shape));--_button-padding-block: var(--forge-button-padding-block, var(--_button-0));--_button-padding-inline: var(--forge-button-padding-inline, var(--_button-padding));--_button-background: var(--forge-button-background, transparent);--_button-hover-background: var(--forge-button-hover-background, var(--_button-background));--_button-active-background: var(--forge-button-active-background, var(--_button-background));--_button-color: var(--forge-button-color, var(--_button-text-color));--_button-icon-size: var(--forge-button-icon-size, calc(var(--forge-typography-font-size, 1rem) * 1.125));--_button-shadow: var(--forge-button-shadow, none);--_button-hover-shadow: var(--forge-button-hover-shadow, none);--_button-active-shadow: var(--forge-button-active-shadow, none);--_button-cursor: var(--forge-button-cursor, pointer);--_button-transition-duration: var(--forge-button-transition-duration, var(--forge-animation-duration-short3, .15s));--_button-transition-timing: var(--forge-button-transition-timing, var(--forge-animation-easing-standard, cubic-bezier(.2, 0, 0, 1)));--_button-text-padding-inline: var(--forge-button-text-padding-inline, var(--forge-spacing-xsmall, 8px));--_button-outlined-background: var(--forge-button-outlined-background, transparent);--_button-outlined-color: var(--forge-button-outlined-color, var(--_button-primary-color));--_button-outlined-border-width: var(--forge-button-outlined-border-width, var(--forge-border-thin, 1px));--_button-outlined-border-style: var(--forge-button-outlined-border-style, solid);--_button-outlined-border-color: var(--forge-button-outlined-border-color, var(--_button-primary-color));--_button-tonal-background: var(--forge-button-tonal-background, var(--forge-theme-primary-container, #d1d5ed));--_button-tonal-disabled-background: var(--forge-button-tonal-disabled-background, var(--_button-disabled-color));--_button-tonal-color: var(--forge-button-tonal-color, var(--forge-theme-on-primary-container, #222c62));--_button-tonal-disabled-color: var(--forge-button-tonal-disabled-color, var(--_button-disabled-text-color));--_button-filled-background: var(--forge-button-filled-background, var(--_button-primary-color));--_button-filled-disabled-background: var(--forge-button-filled-disabled-background, var(--_button-disabled-color));--_button-filled-color: var(--forge-button-filled-color, var(--forge-theme-on-primary, #ffffff));--_button-filled-disabled-color: var(--forge-button-filled-disabled-color, var(--_button-disabled-text-color));--_button-raised-background: var(--forge-button-raised-background, var(--_button-primary-color));--_button-raised-disabled-background: var(--forge-button-raised-disabled-background, var(--_button-disabled-color));--_button-raised-color: var(--forge-button-raised-color, var(--forge-theme-on-primary, #ffffff));--_button-raised-disabled-color: var(--forge-button-raised-disabled-color, var(--_button-disabled-text-color));--_button-raised-shadow: var(--forge-button-raised-shadow, 0px 3px 1px -2px rgba(0, 0, 0, .2), 0px 2px 2px 0px rgba(0, 0, 0, .14), 0px 1px 5px 0px rgba(0, 0, 0, .12));--_button-raised-hover-shadow: var(--forge-button-raised-hover-shadow, 0px 2px 4px -1px rgba(0, 0, 0, .2), 0px 4px 5px 0px rgba(0, 0, 0, .14), 0px 1px 10px 0px rgba(0, 0, 0, .12));--_button-raised-active-shadow: var(--forge-button-raised-active-shadow, 0px 5px 5px -3px rgba(0, 0, 0, .2), 0px 8px 10px 1px rgba(0, 0, 0, .14), 0px 3px 14px 2px rgba(0, 0, 0, .12));--_button-raised-disabled-shadow: var(--forge-button-raised-disabled-shadow, none);--_button-link-color: var(--forge-button-link-color, var(--_button-primary-color));--_button-link-text-decoration: var(--forge-button-link-text-decoration, underline);--_button-link-height: var(--forge-button-link-height, auto);--_button-link-padding: var(--forge-button-link-padding, 0);--_button-link-line-height: var(--forge-button-link-line-height, normal);--_button-link-width: var(--forge-button-link-width, auto);--_button-link-hover-text-decoration: var(--forge-button-link-hover-text-decoration, none);--_button-link-active-opacity: var(--forge-button-link-active-opacity, .65);--_button-link-transition-duration: var(--forge-button-link-transition-duration, var(--forge-animation-duration-short3, .15s));--_button-link-transition-timing: var(--forge-button-link-transition-timing, var(--forge-animation-easing-standard, cubic-bezier(.2, 0, 0, 1)));--_button-disabled-cursor: var(--forge-button-disabled-cursor, not-allowed);--_button-disabled-text-color: var(--forge-button-disabled-text-color, var(--forge-theme-text-low, rgba(0, 0, 0, .38)));--_button-disabled-background: var(--forge-button-disabled-background, transparent);--_button-disabled-border-color: var(--forge-button-disabled-border-color, var(--_button-disabled-color));--_button-disabled-shadow: var(--forge-button-disabled-shadow, none);--_button-dense-height: var(--forge-button-dense-height, 24px);--_button-pill-shape: var(--forge-button-pill-shape, calc(var(--forge-shape-full, 9999px) * var(--forge-shape-factor, 1)));--_button-pill-padding-inline: var(--forge-button-pill-padding-inline, var(--forge-spacing-small, 12px));--_button-focus-indicator-offset: var(--forge-button-focus-indicator-offset, 4px);--_button-text-focus-indicator-offset: var(--forge-button-text-focus-indicator-offset, 0px);--_button-link-focus-indicator-offset: var(--forge-button-link-focus-indicator-offset, 2px);--_button-popover-icon-transition-duration: var(--forge-button-popover-icon-transition-duration, var(--forge-animation-duration-short3, .15s));--_button-popover-icon-transition-timing: var(--forge-button-popover-icon-transition-timing, var(--forge-animation-easing-standard, cubic-bezier(.2, 0, 0, 1)));--_button-popover-icon-open-rotation: var(--forge-button-popover-icon-open-rotation, 180deg)}.forge-button{-webkit-tap-highlight-color:transparent;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-button-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-button-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-button-font-size-scale, .875)));font-weight:var(--forge-typography-button-font-weight, 500);line-height:var(--forge-typography-button-line-height, normal);letter-spacing:var(--forge-typography-button-letter-spacing, .0714285714em);text-transform:var(--forge-typography-button-text-transform, inherit);text-decoration:var(--forge-typography-button-text-decoration, inherit);position:relative;display:var(--_button-display);grid-auto-flow:column;align-items:center;justify-content:var(--_button-justify);gap:var(--_button-spacing);z-index:0;box-sizing:border-box;min-inline-size:var(--_button-min-width);height:var(--_button-height);inline-size:100%;border-width:var(--_button-border-width);border-style:var(--_button-border-style);border-color:var(--_button-border-color);border-start-start-radius:var(--_button-shape-start-start-radius);border-start-end-radius:var(--_button-shape-start-end-radius);border-end-start-radius:var(--_button-shape-end-start-radius);border-end-end-radius:var(--_button-shape-end-end-radius);padding-block:var(--_button-padding-block);padding-inline:var(--_button-padding-inline);box-shadow:var(--_button-shadow);outline:none;-webkit-user-select:none;user-select:none;-webkit-appearance:none;vertical-align:middle;text-decoration:none;white-space:nowrap;background:var(--_button-background);color:var(--_button-color);cursor:var(--_button-cursor);transition-property:box-shadow,background;transition-duration:var(--_button-transition-duration);transition-timing-function:var(--_button-transition-timing)}.forge-button::-moz-focus-inner{padding:0;border:0}.forge-button:hover{--_button-shadow: var(--_button-hover-shadow);background:var(--_button-hover-background)}.forge-button:active{--_button-shadow: var(--_button-active-shadow);background:var(--_button-active-background)}.forge-button{position:relative;inline-size:auto}.forge-button:not(:disabled):not(.forge-button--link){--_state-layer-display: var(--forge-state-layer-display, flex);--_state-layer-color: var(--forge-state-layer-color, var(--forge-theme-on-surface, #000000));--_state-layer-hover-color: var(--forge-state-layer-hover-color, var(--_state-layer-color));--_state-layer-hover-opacity: var(--forge-state-layer-hover-opacity, .08);--_state-layer-pressed-color: var(--forge-state-layer-pressed-color, var(--_state-layer-color));--_state-layer-pressed-opacity: var(--forge-state-layer-pressed-opacity, .12);--_state-layer-hover-duration: var(--forge-state-layer-hover-duration, 15ms);--_state-layer-pressed-duration: var(--forge-state-layer-pressed-duration, 105ms);--_state-layer-animation-duration: var(--forge-state-layer-animation-duration, 375ms)}.forge-button:not(:disabled):not(.forge-button--link):before{position:absolute;backface-visibility:hidden;transform:translateZ(0);background-color:var(--_state-layer-hover-color);inset:0;transition:opacity var(--_state-layer-hover-duration) linear,background-color var(--_state-layer-hover-duration) linear;--_state-layer-hover-duration: var(--forge-state-layer-hover-duration, .1s);content:"";opacity:0;border-radius:inherit}.forge-button:not(:disabled):not(.forge-button--link):hover:before{background-color:var(--_state-layer-hover-color);opacity:var(--_state-layer-hover-opacity)}.forge-button:not(:disabled):not(.forge-button--link):active:before{opacity:var(--_state-layer-pressed-opacity);transition-duration:var(--_state-layer-pressed-duration);--_state-layer-pressed-opacity: var(--forge-state-layer-pressed-opacity, .18)}@keyframes forge-focus-indicator-outward-grow{0%{outline-width:0}to{outline-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-outward-shrink{0%{outline-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-inward-grow{0%{border-width:0}to{border-width:var(--_focus-indicator-active-width)}}@keyframes forge-focus-indicator-inward-shrink{0%{border-width:var(--_focus-indicator-active-width)}}.forge-button:not(:disabled){outline:none}.forge-button:not(:disabled):focus-visible:after{--_focus-indicator-display: var(--forge-focus-indicator-display, flex);--_focus-indicator-width: var(--forge-focus-indicator-width, var(--forge-border-medium, 2px));--_focus-indicator-active-width: var(--forge-focus-indicator-active-width, 6px);--_focus-indicator-color: var(--forge-focus-indicator-color, var(--forge-theme-primary, #3f51b5));--_focus-indicator-shape: var(--forge-focus-indicator-shape, calc(var(--forge-shape-extra-small, 1px) * var(--forge-shape-factor, 1)));--_focus-indicator-duration: var(--forge-focus-indicator-duration, var(--forge-animation-duration-long4, .6s));--_focus-indicator-easing: var(--forge-focus-indicator-easing, var(--forge-animation-easing-emphasized, cubic-bezier(.2, 0, 0, 1)));--_focus-indicator-shape-start-start: var(--forge-focus-indicator-shape-start-start, var(--_focus-indicator-shape));--_focus-indicator-shape-start-end: var(--forge-focus-indicator-shape-start-end, var(--_focus-indicator-shape));--_focus-indicator-shape-end-end: var(--forge-focus-indicator-shape-end-end, var(--_focus-indicator-shape));--_focus-indicator-shape-end-start: var(--forge-focus-indicator-shape-end-start, var(--_focus-indicator-shape));--_focus-indicator-outward-offset: var(--forge-focus-indicator-outward-offset, var(--forge-spacing-xxsmall, 4px));--_focus-indicator-inward-offset: var(--forge-focus-indicator-inward-offset, 0px);--_focus-indicator-offset-block: var(--forge-focus-indicator-offset-block, 0);--_focus-indicator-offset-inline: var(--forge-focus-indicator-offset-inline, 0)}.forge-button:not(:disabled):focus-visible:after{animation-delay:0s,calc(var(--_focus-indicator-duration) * .25);animation-duration:calc(var(--_focus-indicator-duration) * .25),calc(var(--_focus-indicator-duration) * .75);animation-timing-function:var(--_focus-indicator-easing);box-sizing:border-box;color:var(--_focus-indicator-color);display:none;pointer-events:none;position:absolute;margin-block:var(--_focus-indicator-offset-block);margin-inline:var(--_focus-indicator-offset-inline);animation-name:forge-focus-indicator-outward-grow,forge-focus-indicator-outward-shrink;border-end-end-radius:calc(var(--_focus-indicator-shape-end-end) + var(--_focus-indicator-outward-offset));border-end-start-radius:calc(var(--_focus-indicator-shape-end-start) + var(--_focus-indicator-outward-offset));border-start-end-radius:calc(var(--_focus-indicator-shape-start-end) + var(--_focus-indicator-outward-offset));border-start-start-radius:calc(var(--_focus-indicator-shape-start-start) + var(--_focus-indicator-outward-offset));inset:calc(-1 * var(--_focus-indicator-outward-offset));outline:var(--_focus-indicator-width) solid currentColor;content:"";display:block}.forge-button:not(:disabled){--forge-focus-indicator-color: var(--_button-primary-color)}.forge-button:disabled{cursor:var(--_button-disabled-cursor);--_button-background: var(--_button-disabled-background);--_button-color: var(--_button-disabled-text-color);--_button-shadow: var(--_button-disabled-shadow);pointer-events:none;pointer-events:initial}.forge-button:where(:not(.forge-button--outlined,.forge-button--tonal,.forge-button--filled,.forge-button--raised,.forge-button--link)),.forge-button--text{--_button-padding-inline: var(--_button-text-padding-inline)}.forge-button--outlined{--_button-background: var(--_button-outlined-background);--_button-color: var(--_button-outlined-color);--_button-border-width: var(--_button-outlined-border-width);--_button-border-style: var(--_button-outlined-border-style);--_button-border-color: var(--_button-outlined-border-color)}.forge-button--outlined:disabled{--_button-border-color: var(--_button-disabled-border-color)}.forge-button--tonal{--_button-background: var(--_button-tonal-background);--_button-color: var(--_button-tonal-color)}.forge-button--tonal:disabled{--_button-background: var(--_button-tonal-disabled-background);--_button-color: var(--_button-tonal-disabled-color)}.forge-button--filled,.forge-button--raised{--_button-background: var(--_button-filled-background);--_button-color: var(--_button-filled-color);--forge-state-layer-color: var(--_button-filled-color)}.forge-button--filled:disabled,.forge-button--raised:disabled{--_button-background: var(--_button-filled-disabled-background);--_button-color: var(--_button-filled-disabled-color)}.forge-button--raised{--_button-background: var(--_button-raised-background);--_button-color: var(--_button-raised-color);--_button-shadow: var(--_button-raised-shadow)}.forge-button--raised:hover{--_button-shadow: var(--_button-raised-hover-shadow)}.forge-button--raised:active{--_button-shadow: var(--_button-raised-active-shadow)}.forge-button--raised:disabled{--_button-background: var(--_button-raised-disabled-background);--_button-color: var(--_button-raised-disabled-color);--_button-shadow: var(--_button-raised-disabled-shadow)}.forge-button--link{--_button-color: var(--_button-link-color);--_button-height: var(--_button-link-height);--_button-padding: var(--_button-link-padding);--_button-focus-indicator-offset: var(--_button-link-focus-indicator-offset);text-decoration:var(--_button-link-text-decoration);line-height:var(--_button-link-line-height);transition:opacity var(--_button-link-transition-duration) var(--_button-link-transition-timing);inline-size:var(--_button-link-width)}.forge-button--link:hover{text-decoration:var(--_button-link-hover-text-decoration)}.forge-button--link:active{opacity:var(--_button-link-active-opacity)}.forge-button--pill{--_button-shape: var(--_button-pill-shape);--_button-padding-inline: var(--_button-pill-padding-inline);--forge-focus-indicator-shape: var(--_button-pill-shape)}.forge-button{--forge-icon-font-size: var(--_button-icon-size)}.forge-button--dense{--_button-height: var(--_button-dense-height)}:host{display:contents}.container{position:absolute;inset:auto var(--forge-spacing-medium, 16px) var(--forge-spacing-medium, 16px);z-index:10;display:flex;align-items:center;justify-content:space-between;gap:var(--forge-spacing-medium, 16px);padding:var(--forge-spacing-medium, 16px);background-color:var(--forge-theme-surface, #ffffff);border:1px solid var(--forge-theme-outline, #e0e0e0);border-radius:var(--forge-spacing-medium, 16px);box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;animation:slide-up-fade-in .3s cubic-bezier(0,0,0,1)}.text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-body1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-body1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-font-size-scale, .875)));font-weight:var(--forge-typography-body1-font-weight, 400);line-height:var(--forge-typography-body1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-line-height-scale, 1.125)));letter-spacing:var(--forge-typography-body1-letter-spacing, .0357142857em);text-transform:var(--forge-typography-body1-text-transform, inherit);text-decoration:var(--forge-typography-body1-text-decoration, inherit);flex:1;color:var(--forge-theme-on-surface, #000000)}.actions{display:flex;gap:var(--forge-spacing-small, 12px)}@keyframes slide-up-fade-in{0%{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}';var Kt=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,rt=e=>{throw TypeError(e)},E=(e,t,o,a)=>{for(var i=a>1?void 0:a?Qt(t,o):t,d=e.length-1,l;d>=0;d--)(l=e[d])&&(i=(a?l(t,o,i):l(i))||i);return a&&i&&Kt(t,o,i),i},Xt=(e,t,o)=>t.has(e)||rt("Cannot "+o),te=(e,t,o)=>t.has(e)?rt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,o),Q=(e,t,o)=>(Xt(e,t,"access private method"),o),D,it,nt;const ee="forge-ai-confirmation-prompt";let k=class extends et{constructor(){super(...arguments),te(this,D),this.text="",this.confirmText="Confirm",this.denyText="Deny",this.disabled=!1}render(){return y`
      <div class="container" role="alertdialog" aria-labelledby="confirmation-text" aria-modal="false">
        <div id="confirmation-text" class="text">${this.text}</div>
        <div class="actions">
          <button
            class="deny-button forge-button forge-button--outlined"
            ?disabled=${this.disabled}
            aria-label="Deny"
            @click=${Q(this,D,nt)}>
            ${this.denyText}
          </button>
          <button
            class="confirm-button forge-button forge-button--raised"
            ?disabled=${this.disabled}
            aria-label="Confirm"
            @click=${Q(this,D,it)}>
            ${this.confirmText}
          </button>
        </div>
      </div>
    `}};D=new WeakSet;it=function(){const e=new CustomEvent("forge-ai-confirmation-prompt-confirm",{bubbles:!0,composed:!0});this.dispatchEvent(e)};nt=function(){const e=new CustomEvent("forge-ai-confirmation-prompt-deny",{bubbles:!0,composed:!0});this.dispatchEvent(e)};k.styles=tt(Jt);E([u()],k.prototype,"text",2);E([u({attribute:"confirm-text"})],k.prototype,"confirmText",2);E([u({attribute:"deny-text"})],k.prototype,"denyText",2);E([u({type:Boolean})],k.prototype,"disabled",2);k=E([at(ee)],k);const oe=':host{display:block;width:100%;height:100%}forge-ai-chat-interface::part(messages){overflow:hidden}forge-ai-chat-interface forge-ai-message-thread{min-height:0}.session-files{display:flex;flex-direction:column;gap:var(--forge-spacing-xsmall, 8px);min-width:0}.session-files .session-files-header{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-label1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-label1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-font-size-scale, .75)));font-weight:var(--forge-typography-label1-font-weight, 400);line-height:var(--forge-typography-label1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-line-height-scale, 1.25)));letter-spacing:var(--forge-typography-label1-letter-spacing, .0357142857em);text-transform:var(--forge-typography-label1-text-transform, inherit);text-decoration:var(--forge-typography-label1-text-decoration, inherit);color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6))}.session-files .session-files-list::-webkit-scrollbar{height:var(--forge-scrollbar-height, 16px);width:var(--forge-scrollbar-width, 16px)}.session-files .session-files-list::-webkit-scrollbar-track{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-track:hover{background-color:var(--forge-scrollbar-track-container-hover, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-corner{background-color:var(--forge-scrollbar-track-container, var(--forge-theme-surface-container-low, #ebebeb))}.session-files .session-files-list::-webkit-scrollbar-thumb{height:var(--forge-scrollbar-thumb-min-height, 32px);width:var(--forge-scrollbar-thumb-min-width, 32px);border-radius:var(--forge-scrollbar-border-radius, calc(var(--forge-shape-full, 9999px) * var(--forge-shape-factor, 1)));border-width:var(--forge-scrollbar-border-width, 3px);border-style:solid;border-color:transparent;background-color:var(--forge-scrollbar-thumb-container, var(--forge-theme-surface-container-medium, #c2c2c2));background-clip:content-box}.session-files .session-files-list::-webkit-scrollbar-thumb:hover{background-color:var(--forge-scrollbar-thumb-container-hover, var(--forge-theme-surface-container-high, #9e9e9e))}.session-files .session-files-list{display:flex;gap:var(--forge-spacing-small, 12px);overflow-x:auto;padding-block-end:var(--forge-spacing-xsmall, 8px)}.disclaimer{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--forge-typography-label1-font-family, var(--forge-typography-font-family, "Roboto", sans-serif));font-size:var(--forge-typography-label1-font-size, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-font-size-scale, .75)));font-weight:var(--forge-typography-label1-font-weight, 400);line-height:var(--forge-typography-label1-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-line-height-scale, 1.25)));letter-spacing:var(--forge-typography-label1-letter-spacing, .0357142857em);text-transform:var(--forge-typography-label1-text-transform, inherit);text-decoration:var(--forge-typography-label1-text-decoration, inherit);color:var(--forge-theme-text-medium, rgba(0, 0, 0, .6));text-align:center;margin-block-start:var(--forge-spacing-xxsmall, 4px);margin-block-end:calc(var(--forge-spacing-small, 12px) * -1)}';var ae=Object.defineProperty,se=Object.getOwnPropertyDescriptor,lt=e=>{throw TypeError(e)},p=(e,t,o,a)=>{for(var i=a>1?void 0:a?se(t,o):t,d=e.length-1,l;d>=0;d--)(l=e[d])&&(i=(a?l(t,o,i):l(i))||i);return a&&i&&ae(t,o,i),i},N=(e,t,o)=>t.has(e)||lt("Cannot "+o),s=(e,t,o)=>(N(e,t,"read from private field"),o?o.call(e):t.get(e)),v=(e,t,o)=>t.has(e)?lt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,o),_=(e,t,o,a)=>(N(e,t,"write to private field"),t.set(e,o),o),n=(e,t,o)=>(N(e,t,"access private method"),o),X=(e,t,o,a)=>({set _(i){_(e,t,i)},get _(){return s(e,t,a)}}),W,R,x,F,c,h,w,T,$,g,r,dt,z,A,ct,ht,ut,B,C,q,ft,pt,gt,bt,H,mt,vt,_t,L,yt,j,xt,wt,kt,Ct,M,Y,Tt,P,$t,Mt,It,Rt,Et,zt,At,G,St,Dt,Ut,Ft,Bt,Pt,Ot,Wt,V,Z,J,qt,K,Nt,Ht,Lt,jt,m;const re="forge-ai-chatbot";let f=class extends et{constructor(){super(...arguments),v(this,r),this.fileUpload="off",this.voiceInput="on",this.debugCommand="on",this.placeholder="Ask a question...",this.showExpandButton=!1,this.showMinimizeButton=!1,this.expanded=!1,this.minimizeIcon="default",this.enableReactions=!1,this.titleText="AI Assistant",this.headingLevel=2,this.debugMode=!1,this.disclaimerText="AI can make mistakes. Always verify responses.",v(this,W,S()),v(this,R,S()),v(this,x,S()),v(this,F,S()),v(this,c),v(this,h),v(this,w),v(this,T),v(this,$,0),v(this,g)}connectedCallback(){super.connectedCallback(),_(this,c,new Zt(this,{tools:s(this,r,C)})),_(this,h,new Vt({onError:e=>{n(this,r,m).call(this,{type:"forge-ai-chatbot-error",detail:{error:e}})},onStateChange:()=>{this.requestUpdate()}})),this.adapter&&n(this,r,q).call(this)}disconnectedCallback(){super.disconnectedCallback(),s(this,T)?.unsubscribe(),this.adapter?.disconnect()}willUpdate(e){e.has("adapter")&&this.adapter&&(_(this,w,void 0),n(this,r,q).call(this))}clearMessages(){s(this,c).clearMessages(),s(this,h).clear()}getMessages(){return s(this,c).getMessages()}setMessages(e){s(this,c).setMessages(e)}async sendMessage(e,t){if(!this.adapter){console.warn("No adapter configured.");return}if(s(this,x).value?.closeSlashMenu(),t){const o=Date.now();for(const a of t)n(this,r,G).call(this,a,o)}await n(this,r,Y).call(this,{content:e,attachments:s(this,h).pendingAttachments})}abort(){n(this,r,P).call(this)}async scrollToBottom({behavior:e}={}){await s(this,R).value?.updateComplete,await new Promise(requestAnimationFrame),s(this,R).value?.scrollToBottom({behavior:e})}getThreadState(){return{threadId:this.adapter?.threadId,messages:this.getMessages(),timestamp:Date.now()}}setThreadState(e){this.setMessages(e.messages),e.threadId&&this.adapter&&(this.adapter.threadId=e.threadId)}render(){return y`
      <forge-ai-chat-interface
        ${U(s(this,W))}
        role="region"
        aria-label="AI chatbot"
        aria-live="polite"
        aria-busy=${s(this,r,A)}>
        <forge-ai-chat-header
          ${U(s(this,F))}
          slot="header"
          ?show-expand-button=${this.showExpandButton}
          ?show-minimize-button=${this.showMinimizeButton}
          ?expanded=${this.expanded}
          export-option=${s(this,r,B)?"enabled":"off"}
          clear-option=${s(this,r,B)?"enabled":"off"}
          .minimizeIcon=${this.minimizeIcon}
          .agentInfo=${this.agentInfo}
          .headingLevel=${this.headingLevel}
          .titleText=${this.titleText}
          @forge-ai-chat-header-expand=${n(this,r,Ot)}
          @forge-ai-chat-header-minimize=${n(this,r,Wt)}
          @forge-ai-chat-header-clear=${n(this,r,V)}
          @forge-ai-chat-header-export=${n(this,r,K)}
          @forge-ai-chat-header-info=${n(this,r,Z)}>
        </forge-ai-chat-header>
        ${s(this,r,Nt)} ${s(this,r,jt)} ${s(this,r,Ht)} ${s(this,r,Lt)}
        ${O(this.disclaimerText,()=>y`<div class="disclaimer" slot="disclaimer">${this.disclaimerText}</div>`)}
      </forge-ai-chat-interface>
    `}};W=new WeakMap;R=new WeakMap;x=new WeakMap;F=new WeakMap;c=new WeakMap;h=new WeakMap;w=new WeakMap;T=new WeakMap;$=new WeakMap;g=new WeakMap;r=new WeakSet;dt=function(){const e=[];return s(this,r,B)&&(e.push({id:"clear",name:"Clear",group:"Conversation"}),e.push({id:"export",name:"Export",group:"Conversation"})),e.push({id:"info",name:"Info",group:"Help"}),this.debugCommand==="on"&&e.push({id:"debug",name:`${this.debugMode?"Disable debug mode":"Enable debug mode"}`,group:"Help"}),e};z=function(){return s(this,c)?.messageItems??[]};A=function(){return(this.adapter?.isRunning??!1)||s(this,$)>0};ct=function(){return s(this,g)!==void 0};ht=function(){return s(this,r,z).filter(e=>!(e.type==="toolCall"&&e.data.name===st))};ut=function(){return s(this,h)?.isUploading??!1};B=function(){return s(this,r,z).length>0};C=function(){return s(this,w)||_(this,w,new Map(this.adapter?.getTools().map(e=>[e.name,e])??[])),s(this,w)};q=async function(){!this.adapter||this.adapter.isConnecting||(await this.adapter.connect(),s(this,T)?.unsubscribe(),_(this,T,new Yt),s(this,T).add(this.adapter.onMessageStart(n(this,r,ft).bind(this)),this.adapter.onMessageDelta(n(this,r,pt).bind(this)),this.adapter.onMessageEnd(n(this,r,gt).bind(this)),this.adapter.onToolCallStart(n(this,r,mt).bind(this)),this.adapter.onToolCallArgs(n(this,r,vt).bind(this)),this.adapter.onToolCallEnd(n(this,r,_t).bind(this)),this.adapter.onToolCall(n(this,r,yt).bind(this)),this.adapter.onToolCallResult(n(this,r,Ct).bind(this)),this.adapter.onRunFinished(n(this,r,bt).bind(this)),this.adapter.onRunAborted(n(this,r,wt).bind(this)),this.adapter.onError(n(this,r,xt).bind(this)),this.adapter.onStateChange(n(this,r,kt).bind(this))),_(this,w,void 0),s(this,c)?.updateConfig({tools:s(this,r,C)}),n(this,r,m).call(this,{type:"forge-ai-chatbot-connected"}))};ft=function(e){s(this,c).addTextToResponse(e.messageId,"",e)};pt=function(e){s(this,c).appendTextDelta(e.messageId,e.delta,e),this.scrollToBottom()};gt=function(e){s(this,c).markTextComplete(e.messageId,e)};bt=function(){n(this,r,H).call(this)};H=function(){s(this,$)>0||this.adapter?.isRunning||s(this,g)||s(this,c).completeResponse()};mt=function(e){const t={id:e.id,messageId:e.messageId,name:e.name,args:{},argsBuffer:"",status:"parsing",type:s(this,r,C).has(e.name)?"client":"agent"};s(this,c).addToolCallToResponse(t,e)};vt=function(e){const t={argsBuffer:e.argsBuffer,args:e.partialArgs??{}},o={eventType:"tool-call-args",event:e};s(this,c).updateToolCallInResponse(e.id,t,o),this.scrollToBottom()};_t=function(e){const t={args:e.args,argsBuffer:void 0,status:"executing"},o={eventType:"tool-call-end",event:e};s(this,c).updateToolCallInResponse(e.id,t,o)};L=function(e,t){return typeof t=="string"||t&&typeof t=="object"?t:`Tool '${e}' executed successfully`};yt=async function(e){let t=s(this,c).getToolCall(e.id);if(t?s(this,c).updateToolCallInResponse(e.id,{args:e.args,status:"executing"}):(t={id:e.id,messageId:e.messageId,name:e.name,args:e.args,status:"executing",type:s(this,r,C).has(e.name)?"client":"agent"},s(this,c).addToolCallToResponse(t)),e.name===st){const o=e.args;_(this,g,{type:"llm-driven",toolCallId:e.id,displayText:o.action??""}),this.requestUpdate();return}if(t?.type==="client"){n(this,r,m).call(this,{type:"forge-ai-chatbot-tool-call",detail:{toolCallId:e.id,toolName:e.name,arguments:e.args}});const o=s(this,r,C).get(e.name);if(o?.handler){const a=!!o.renderer;o.skipConfirmation||a?await Promise.resolve(n(this,r,j).call(this,e.id,e.name,o.handler,e.args)):(_(this,g,{type:"auto-intercept",toolCallId:e.id,displayText:o.displayName??e.name,toolName:e.name,args:e.args,handler:o.handler}),this.requestUpdate())}else n(this,r,M).call(this,e.id,n(this,r,L).call(this,e.name))}};j=async function(e,t,o,a){X(this,$)._++,this.requestUpdate();try{const d=await o({args:a,toolCallId:e,toolName:t,signal:void 0});await n(this,r,M).call(this,e,n(this,r,L).call(this,t,d))}catch(i){s(this,c).updateToolCallInResponse(e,{status:"error",result:{error:i.message}})}finally{X(this,$)._--,n(this,r,H).call(this),this.requestUpdate()}};xt=function(e){const t={id:I(),role:"assistant",content:e.message,timestamp:Date.now(),status:"error"};s(this,c).addMessage(t),n(this,r,m).call(this,{type:"forge-ai-chatbot-error",detail:{error:e.message}})};wt=function(){const e={id:I(),role:"system",content:"Run cancelled",timestamp:Date.now(),status:"complete"};s(this,c).addMessage(e)};kt=function(e){this.requestUpdate()};Ct=function(e){s(this,c).completeToolCallInResponse(e.toolCallId,e.result,e)};M=async function(e,t){!s(this,c).getToolCall(e)||!this.adapter||(s(this,c).completeToolCallInResponse(e,t),this.adapter.sendToolResult(e,t,this.getMessages()))};Y=async function(e){if(!e.content.trim()||!this.adapter||s(this,r,A)){this.adapter||console.warn("No adapter configured.");return}if(!s(this,h).canSend())return;const t={id:I(),role:"user",content:e.content,timestamp:e.timestamp??Date.now(),status:"pending"};s(this,c).addMessage(t),n(this,r,m).call(this,{type:"forge-ai-chatbot-message-sent",detail:{message:t}});try{this.adapter.sendMessage(this.getMessages()),s(this,c).updateMessageStatus(t.id,"complete")}catch(o){s(this,c).updateMessageStatus(t.id,"error");const a=o instanceof Error?o.message:"Failed to send message";n(this,r,m).call(this,{type:"forge-ai-chatbot-error",detail:{error:a}})}};Tt=async function(e){const t=[...s(this,h).pendingAttachments];await n(this,r,Y).call(this,{content:e.detail.value,timestamp:e.detail.date.getTime(),attachments:t})};P=function(){this.adapter?.isRunning&&this.adapter.abort(),this.requestUpdate()};$t=function(){n(this,r,P).call(this)};Mt=function(){if(!s(this,g))return;const{type:e,toolCallId:t,displayText:o,toolName:a,args:i,handler:d}=s(this,g);if(_(this,g,void 0),e==="llm-driven"){const l={status:"confirmed",action:o};n(this,r,M).call(this,t,l)}else e==="auto-intercept"&&d&&a&&i&&n(this,r,j).call(this,t,a,d,i);this.requestUpdate()};It=function(){if(!s(this,g))return;const{type:e,toolCallId:t,displayText:o,toolName:a}=s(this,g);if(_(this,g,void 0),e==="llm-driven"){const i={status:"denied",action:o};n(this,r,M).call(this,t,i)}else if(e==="auto-intercept"){const i={denied:!0,toolName:a??"unknown",message:"User denied this action"};n(this,r,M).call(this,t,i)}this.requestUpdate()};Rt=async function(e){const t=e.detail.messageId,o=s(this,r,z).find(i=>i.type==="assistant"&&i.data.id===t);if(!o||o.type!=="assistant")return;const a=o.data.children.filter(i=>i.type==="text").map(i=>i.content).join(`

`);try{await navigator.clipboard.writeText(a)}catch{}};Et=function(e){if(!this.adapter)return;const t=e.detail.messageId,o=s(this,r,z).findIndex(a=>a.type==="assistant"&&a.data.id===t);o!==-1&&(s(this,c).removeMessageItemsFrom(o),this.adapter.sendMessage(this.getMessages()))};zt=function(e){console.warn("thumbs-up",e.detail.messageId)};At=function(e){console.warn("thumbs-down",e.detail.messageId)};G=function(e,t){const o=I();s(this,h).addAttachment(o,{filename:e.name,size:e.size,mimeType:e.type,timestamp:t});const a=n(this,r,Dt).call(this,o);this.adapter?.emitFileUpload(e,a),n(this,r,m).call(this,{type:"forge-ai-chatbot-file-select",detail:{fileId:o,file:e,filename:e.name,size:e.size,mimeType:e.type,timestamp:t,...a}})};St=function(e){const{file:t,timestamp:o}=e.detail;n(this,r,G).call(this,t,o)};Dt=function(e){return{updateProgress:t=>{s(this,h).updateProgress(e,t)},markComplete:t=>{s(this,h).markComplete(e,t)},markError:t=>{s(this,h).markError(e,t)},onAbort:t=>{s(this,h).registerOnAbort(e,t)}}};Ut=function(e){const t={id:I(),role:"assistant",content:e.detail.message,timestamp:Date.now(),status:"error"};s(this,c).addMessage(t)};Ft=function(e){const{filename:t}=e.detail,o=s(this,h).pendingAttachments.find(i=>i.filename===t);if(o){s(this,h).abort(o.id);return}const a=s(this,h).completedAttachments.find(i=>i.filename===t);a&&a.fileId&&(s(this,h).removeCompletedAttachment(a.id),this.requestUpdate(),this.adapter?.emitFileRemove(a.fileId,{onSuccess:()=>{},onError:i=>{console.error(`Failed to remove file ${t}:`,i)}}))};Bt=async function(e){s(this,x).value?.addToHistory(e.detail.text),await this.sendMessage(e.detail.text),s(this,x).value?.focus()};Pt=function(e){const{transcript:t}=e.detail;t&&s(this,x).value&&(s(this,x).value.value=t)};Ot=function(){n(this,r,m).call(this,{type:"forge-ai-chatbot-expand"})};Wt=function(){n(this,r,m).call(this,{type:"forge-ai-chatbot-minimize"})};V=function(){n(this,r,m).call(this,{type:"forge-ai-chatbot-clear",cancelable:!0}).defaultPrevented||this.clearMessages()};Z=function(){const e=s(this,F).value;e?.showAgentInfo&&e.showAgentInfo(),n(this,r,m).call(this,{type:"forge-ai-chatbot-info"})};J=function(){this.debugMode=!this.debugMode};qt=function(e){switch(e.detail.commandId){case"clear":n(this,r,V).call(this);break;case"export":n(this,r,K).call(this);break;case"info":n(this,r,Z).call(this);break;case"debug":n(this,r,J).call(this);break}};K=function(){const e=this.getMessages();if(e.length===0)return;const t=e.map(a=>{const i=new Date(a.timestamp).toLocaleString(),d=a.role==="user"?"You":"Assistant";return`[${i}] ${d}:
${a.content}
`}).join(`
`),o=`chat-history-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`;Gt(t,o,"text/plain")};Nt=function(){const e=s(this,h).completedAttachments,o=[...s(this,h).pendingAttachments,...e];return o.length===0?ot:y`
      <div class="session-files" slot="attachments">
        <div class="session-files-header">Session Files (${o.length})</div>
        <div class="session-files-list">
          ${o.map(a=>y`
              <forge-ai-attachment
                .filename=${a.filename}
                .size=${a.size}
                ?uploading=${a.uploading??!1}
                removable
                @forge-ai-attachment-remove=${n(this,r,Ft)}>
              </forge-ai-attachment>
            `)}
        </div>
      </div>
    `};Ht=function(){return s(this,g)?y`
      <forge-ai-confirmation-prompt
        slot="confirmation"
        .text=${s(this,g).displayText}
        @forge-ai-confirmation-prompt-confirm=${n(this,r,Mt)}
        @forge-ai-confirmation-prompt-deny=${n(this,r,It)}>
      </forge-ai-confirmation-prompt>
    `:ot};Lt=function(){const e=s(this,r,ut),t=e||s(this,r,ct);return y`
      <forge-ai-prompt
        ${U(s(this,x))}
        slot="prompt"
        .placeholder=${this.placeholder}
        .running=${s(this,r,A)||e}
        .slashCommands=${s(this,r,dt)}
        ?disabled=${t}
        ?debug-mode=${this.debugMode}
        @forge-ai-prompt-send=${n(this,r,Tt)}
        @forge-ai-prompt-stop=${n(this,r,P)}
        @forge-ai-prompt-cancel=${n(this,r,$t)}
        @forge-ai-prompt-debug-toggle=${n(this,r,J)}
        @forge-ai-prompt-command=${n(this,r,qt)}>
        ${O(this.fileUpload==="on",()=>y`
            <forge-ai-file-picker
              slot="actions"
              variant="icon-button"
              multiple
              ?disabled=${e}
              .selectedFiles=${s(this,h).pendingAttachments.map(o=>o.filename)}
              @forge-ai-file-picker-change=${n(this,r,St)}
              @forge-ai-file-picker-error=${n(this,r,Ut)}>
            </forge-ai-file-picker>
          `)}
        ${O(this.voiceInput==="on",()=>y`
            <forge-ai-voice-input slot="actions" @forge-ai-voice-input-result=${n(this,r,Pt)}>
            </forge-ai-voice-input>
          `)}
      </forge-ai-prompt>
    `};jt=function(){return y`
      <forge-ai-message-thread
        ${U(s(this,R))}
        .messageItems=${s(this,r,ht)}
        .tools=${s(this,r,C)}
        ?enable-reactions=${this.enableReactions}
        ?show-thinking=${s(this,r,A)}
        ?debug-mode=${this.debugMode}
        @forge-ai-message-thread-copy=${n(this,r,Rt)}
        @forge-ai-message-thread-refresh=${n(this,r,Et)}
        @forge-ai-message-thread-thumbs-up=${n(this,r,zt)}
        @forge-ai-message-thread-thumbs-down=${n(this,r,At)}>
        <slot name="empty-state-heading" slot="empty-state-heading"></slot>
        <slot name="empty-state-message" slot="empty-state-message"></slot>
        <forge-ai-suggestions
          slot="empty-state-actions"
          variant="block"
          .suggestions=${this.suggestions??[]}
          @forge-ai-suggestions-select=${n(this,r,Bt)}>
        </forge-ai-suggestions>
      </forge-ai-message-thread>
    `};m=function(e){const t=new CustomEvent(e.type,{detail:e.detail,bubbles:!0,composed:!0,cancelable:e.cancelable??!1});return this.dispatchEvent(t),t};f.styles=tt(oe);p([u({attribute:!1})],f.prototype,"adapter",2);p([u({attribute:"file-upload"})],f.prototype,"fileUpload",2);p([u({attribute:"voice-input"})],f.prototype,"voiceInput",2);p([u({attribute:"debug-command"})],f.prototype,"debugCommand",2);p([u()],f.prototype,"placeholder",2);p([u({attribute:!1})],f.prototype,"suggestions",2);p([u({type:Boolean,attribute:"show-expand-button"})],f.prototype,"showExpandButton",2);p([u({type:Boolean,attribute:"show-minimize-button"})],f.prototype,"showMinimizeButton",2);p([u({type:Boolean})],f.prototype,"expanded",2);p([u({attribute:"minimize-icon"})],f.prototype,"minimizeIcon",2);p([u({type:Boolean,attribute:"enable-reactions"})],f.prototype,"enableReactions",2);p([u({type:Object,attribute:!1})],f.prototype,"agentInfo",2);p([u({attribute:"title-text"})],f.prototype,"titleText",2);p([u({attribute:"heading-level",type:Number})],f.prototype,"headingLevel",2);p([u({type:Boolean,attribute:"debug-mode"})],f.prototype,"debugMode",2);p([u({attribute:"disclaimer-text"})],f.prototype,"disclaimerText",2);f=p([at(re)],f);
